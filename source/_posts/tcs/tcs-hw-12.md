---
title: TCS Homework 12
date: 2025-05-31 20:37:20
tags:
    - tcs
excerpt: TCS Homework 12
---

## 12.1
### 题目
**问题 1.** 设 $G$ 是一个拉伸为 $\ell$ 的伪随机生成器，满足 $\ell(n) \geq 2n$（即对于输入长度 $n$，输出长度至少为 $2n$）。

(a) 定义 $G'$ 为 $G'(s) = G(s0^{|s|})$。$G'$ 是否一定是一个伪随机生成器？

(b) 定义 $G''$ 为 $G''(s) = G(s_1 \cdots s_{n/2})$，其中 $s = s_1 s_2 \cdots s_n$（假设 $n$ 为偶数）。$G''$ 是否一定是一个伪随机生成器？

### 解答
伪随机生成器（PRG）的标准定义要求：
1. **拉伸条件**：输出长度严格大于输入长度，即 $\ell(n) > n$。
2. **计算不可区分性**：对于所有概率多项式时间（PPT）区分器 $D$，区分器无法以不可忽略的优势区分生成器的输出与均匀随机字符串。

给定 $G$ 是 PRG 且满足 $\ell(n) \geq 2n$，分析 $G'$ 和 $G''$。

#### (a) $G'(s) = G(s0^{|s|})$ 是否一定是伪随机生成器？
**答案：否**，$G'$ 不一定是伪随机生成器。

**解释：**
- $G'$ 的输入为 $s$（长度 $n$），计算 $s0^{|s|} = s0^n$（长度 $2n$），然后应用 $G$ 得到输出 $G(s0^n)$。
- $G$ 是 PRG，因此当输入长度为 $2n$ 时，输出长度为 $\ell(2n) \geq 4n$。
- 问题在于 $G'$ 的输入到 $G$ 的种子 $s0^n$ 不是均匀随机的：后 $n$ 位固定为 0，只有前 $n$ 位随机。因此，输入种子的熵仅为 $n$ 位（而非 $2n$ 位）。
- 尽管 $G$ 本身是 PRG，但当应用于一个非均匀分布（特别是后一半固定为 0）时，输出可能失去伪随机性。

**反例构造：**
- 定义 $G: \{0,1\}^m \to \{0,1\}^{\ell(m)}$ 如下（其中 $\ell(m) = 2m$ 为简单起见）：
  - 如果输入 $x$ 的后 $m/2$ 位全为 0，则输出 $x$ 的前 $m/2$ 位重复多次，使得输出长度为 $2m$（例如，输出 $(x_1 \cdots x_{m/2})^4$）。
  - 否则，输出 $H(x)$，其中 $H$ 是一个安全的 PRG（例如，基于密码学假设的标准 PRG）。
- 验证 $G$ 是 PRG：
  - 当输入 $x$ 均匀随机时，后 $m/2$ 位全为 0 的概率为 $2^{-m/2}$（可忽略）。
  - 以概率 $1 - 2^{-m/2}$，输出为 $H(x)$，与均匀随机不可区分。
  - 以概率 $2^{-m/2}$，输出为重复模式，但此事件概率可忽略，因此整体计算不可区分性成立。
- 现在考虑 $G'(s) = G(s0^n)$（输入长度 $n$，输出长度 $\ell(2n) = 4n$）：
  - 输入 $s0^n$ 的后 $n$ 位全为 0，因此 $G(s0^n) = (s_1 \cdots s_n)^4$（即 $s$ 重复四次）。
- 区分器 $D$ 攻击 $G'$：
  - 输入 $y$（长度 $4n$），检查 $y$ 是否每 $n$ 位块相同（即 $y[1..n] = y[n+1..2n] = y[2n+1..3n] = y[3n+1..4n]$）。
  - 如果是，输出“伪随机”；否则输出“随机”。
- 分析：
  - $\Pr[D(G'(s)) = 1] = 1$（因为输出总是重复模式）。
  - $\Pr[D(r) = 1]$（其中 $r$ 均匀随机）为 $r$ 每 $n$ 位块相同的概率，即 $2^{-3n}$（可忽略）。
  - 优势 $\left| \Pr[D(G'(s)) = 1] - \Pr[D(r) = 1] \right| = |1 - \text{negl}(n)| \approx 1$，不是可忽略函数。
- 因此，$G'$ 不是 PRG。

此反例显示，存在 $G$ 是 PRG，但 $G'$ 不是 PRG。

#### (b) $G''(s) = G(s_1 \cdots s_{n/2})$ 是否一定是伪随机生成器？
**答案：否**，$G''$ 不一定是伪随机生成器。

**解释：**
- $G''$ 的输入为 $s$（长度 $n$），但仅使用前一半 $s_1 \cdots s_{n/2}$（长度 $n/2$）作为 $G$ 的输入，输出 $G(s_1 \cdots s_{n/2})$。
- $G$ 是 PRG，因此当输入长度为 $n/2$ 时，输出长度为 $\ell(n/2) \geq 2 \times (n/2) = n$。
- 问题在于拉伸条件：$\ell(n/2)$ 可能等于 $n$（例如，如果 $\ell(m) = 2m$，则 $\ell(n/2) = n$），此时输出长度等于输入长度 $n$，违反 PRG 的拉伸要求（输出必须严格长于输入）。
- 即使计算不可区分性可能成立（因为输出分布等同于 $G$ 在输入长度 $n/2$ 时的输出），拉伸不足本身已导致 $G''$ 不符合 PRG 定义。

**反例构造：**
- 取 $\ell(m) = 2m$（满足 $\ell(m) \geq 2m$）。
- 定义 $G: \{0,1\}^m \to \{0,1\}^{2m}$ 为 $G(z) = z \| H(z)$，其中 $H$ 是一个安全的 PRG。则 $G$ 是 PRG，因为输出包含真随机部分。
- 现在 $G''(s) = G(s_1 \cdots s_{n/2}) = s_1 \cdots s_{n/2} \| H(s_1 \cdots s_{n/2})$（长度 $n$）。
- 输入长度 $n$，输出长度 $n$，拉伸为 $n/n = 1 \not> n$，不满足拉伸条件。
- 此外，统计距离大：输出分布的支持集大小最多 $2^{n/2}$（因为输入到 $G$ 只有 $n/2$ 位），而输出空间大小为 $2^n$，统计距离至少 $1 - 2^{n/2} / 2^n = 1 - 2^{-n/2}$（不是可忽略函数），因此存在区分器（无界）有显著优势。

此反例显示，当 $\ell(n/2) = n$ 时，$G''$ 不满足 PRG 的拉伸要求。即使在某些 $G$ 下计算安全，但由于“necessarily”要求对所有 $G$ 成立，而存在反例，因此 $G''$ 不一定是 PRG。


## 12.2
### 题目
一个密钥函数族 $F_k$ 被称为伪随机置换（PRP），如果满足以下条件：  
- 给定密钥 $k$，函数 $F_k(\cdot)$ 和其逆函数 $F_k^{-1}(\cdot)$ 是高效可计算的；  
- 对于任意多项式时间的敌手 $\mathcal{A}$：  

$$
\left| \Pr\left( \mathcal{A}^{F_k(\cdot), F_k^{-1}(\cdot)} (1^n) = 1 \right) - \Pr\left( \mathcal{A}^{f_n(\cdot), f_n^{-1}(\cdot)} (1^n) = 1 \right) \right| \leq \text{negl}(n),
$$  

其中 $f_n$ 是一个随机置换。  

考虑以下加密方案：  
1. 均匀采样密钥 $k$。  
2. 对于明文 $x \in \{0, 1\}^{n/2}$（假设 $n$ 为偶数），加密算法 $\text{Enc}_k$ 采样随机数 $r \in \{0, 1\}^{n/2}$，并输出 $F_k(r \| x)$。  

假设 $F_k$ 是一个 PRP：  

(a) 展示解密算法 $\text{Dec}_k$ 如何工作。  
(b) 证明该加密方案在 CPA（选择明文攻击）下是安全的。  


### 解答

#### (a) 解密算法 $\text{Dec}_k$ 的工作方式
给定密文 $c$（长度为 $n$，因为 $F_k$ 的输出长度是 $n$)，解密算法 $\text{Dec}_k$ 执行以下步骤：  
1. **计算逆置换**：使用密钥 $k$ 计算 $m = F_k^{-1}(c)$。这里 $m$ 是一个长度为 $n$ 的字符串。  
2. **解析明文**：将 $m$ 分为两部分：  
   - 前 $n/2$ 位是随机数 $r$（在加密过程中生成），  
   - 后 $n/2$ 位是原始明文 $x$。  
   即 $m = r \| x$。  
3. **输出明文**：输出后 $n/2$ 位作为明文 $x$。  

**形式化定义**：  
$$ \text{Dec}_k(c) = \text{后 } n/2 \text{ 位} \text{ 的 } F_k^{-1}(c). $$  

**正确性验证**：  
- 加密时，$\text{Enc}_k(x) = F_k(r \| x)$。  
- 解密时，$F_k^{-1}(c) = F_k^{-1}(F_k(r \| x)) = r \| x$。  
- 提取后 $n/2$ 位直接得到 $x$，故解密正确恢复明文。  

#### (b) 证明加密方案是 CPA 安全的
CPA 安全性要求：任意多项式时间敌手 $\mathcal{A}$ 在 CPA 游戏中的优势可忽略。CPA 游戏定义如下：  
1. 挑战者均匀采样密钥 $k$。  
2. $\mathcal{A}$ 可适应性地查询加密预言机：输入明文 $x$，预言机返回 $\text{Enc}_k(x)$。  
3. $\mathcal{A}$ 提交两个等长明文 $x_0, x_1 \in \{0, 1\}^{n/2}$。  
4. 挑战者采样随机比特 $b \leftarrow \{0,1\}$ 和随机数 $r^* \leftarrow \{0,1\}^{n/2}$，计算挑战密文 $c^* = F_k(r^* \| x_b)$，并返回 $c^*$ 给 $\mathcal{A}$。  
5. $\mathcal{A}$ 可继续查询加密预言机（但不能解密 $c^*$)，最后输出猜测比特 $b'$。  
敌手的优势定义为：  
$$ \text{Adv}_{\text{CPA}}(\mathcal{A}) = \left| \Pr[b' = b] - \frac{1}{2} \right|. $$  

**证明**：  
使用混合论证（Hybrid Argument），基于 $F_k$ 是 PRP 的假设。  

- **Game 0**：真实 CPA 游戏。  
  - 加密预言机：对查询 $x$，采样 $r \leftarrow \{0,1\}^{n/2}$，返回 $c = F_k(r \| x)$。  
  - 挑战阶段：对 $x_0, x_1$，采样 $r^* \leftarrow \{0,1\}^{n/2}$，计算 $c^* = F_k(r^* \| x_b)$。  

- **Game 1**：将 $F_k$ 替换为随机置换 $\pi$（均匀采样于所有 $\{0,1\}^n \to \{0,1\}^n$ 的置换）。  
  - 加密预言机：对查询 $x$，采样 $r \leftarrow \{0,1\}^{n/2}$，返回 $c = \pi(r \| x)$。  
  - 挑战阶段：对 $x_0, x_1$，采样 $r^* \leftarrow \{0,1\}^{n/2}$，计算 $c^* = \pi(r^* \| x_b)$。  

**步骤 1：Game 0 和 Game 1 计算不可区分**  
- 由于 $F_k$ 是 PRP，敌手即使有访问 $F_k$ 和 $F_k^{-1}$ 预言机也无法区分 $F_k$ 与随机置换 $\pi$。  
- 在 CPA 游戏中，敌手仅访问加密预言机（无逆预言机），因此：  
  $$
  \left| \Pr[\mathcal{A} \text{ 在 Game 0 获胜}] - \Pr[\mathcal{A} \text{ 在 Game 1 获胜}] \right| \leq \text{negl}(n).
  $$  
  若该差不可忽略，则可构造区分器打破 PRP 假设。

**步骤 2：分析 Game 1 的优势**  
设敌手最多进行 $q = \text{poly}(n)$ 次加密查询。定义事件 **Coll**（碰撞）：  
- 挑战输入 $r^* \| x_b$ 等于某个加密查询的输入 $r^{(i)} \| x^{(i)}$（即 $r^* = r^{(i)}$ 且 $x_b = x^{(i)}$ 对某个 $i$)。  

**碰撞概率分析**：  
- 每个加密查询的 $r^{(i)}$ 独立均匀采样。  
- 挑战阶段 $r^*$ 独立均匀采样（与历史独立）。  
- 敌手选择 $x_b$ 时，已知历史查询但未知 $r^*$，故：  
  $$
  \Pr[\text{Coll}] \leq \sum_{i=1}^{q} \Pr[r^* = r^{(i)} \land x_b = x^{(i)}] \leq q \cdot 2^{-n/2} \leq \text{negl}(n),
  $$  
  因为 $q = \text{poly}(n)$，$2^{-n/2}$ 指数小。

**无碰撞时的安全性**：  
- 若 ¬Coll 发生，则挑战输入 $r^* \| x_b$ 新鲜（未在加密查询中出现）。  
- 由于 $\pi$ 是随机置换，且输入点唯一，挑战密文 $c^* = \pi(r^* \| x_b)$ 在 $\{0,1\}^n$ 上均匀随机，且独立于历史视图。  
- 因此，敌手无法猜测 $b$：  
  $$
  \Pr[b' = b \mid \neg \text{Coll}] = \frac{1}{2}.
  $$  

**Game 1 的总优势**：  
$$
\Pr[b' = b] = \underbrace{\Pr[b' = b \mid \text{Coll}]}_{\leq 1} \Pr[\text{Coll}] + \underbrace{\Pr[b' = b \mid \neg \text{Coll}]}_{= \frac{1}{2}} \Pr[\neg \text{Coll}].
$$  
代入边界：  
$$
\left| \Pr[b' = b] - \frac{1}{2} \right| \leq \Pr[\text{Coll}] \leq \text{negl}(n).
$$  
故在 Game 1 中，敌手优势可忽略。

**步骤 3：归结到 Game 0**  
- Game 0 和 Game 1 计算不可区分，且 Game 1 中优势可忽略，因此在 Game 0 中：  
  $$
  \text{Adv}_{\text{CPA}}(\mathcal{A}) \leq \text{negl}(n).
  $$  

结论：该加密方案是 CPA 安全的。  