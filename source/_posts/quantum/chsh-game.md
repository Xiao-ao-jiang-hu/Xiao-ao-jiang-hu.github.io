---
title: 贝尔不等式与 CHSH 游戏
tags:
  - quantum
categories:
  - quantum
index_img: /img/quan.jpg
banner_img: /img/quan.jpg
excerpt: no excerpt
abbrlink: c4a4f6d1
date: 2025-11-11 20:26:39
---
## 量子非局域性：贝尔不等式
贝尔不等式（Bell's inequality）由物理学家约翰·贝尔于1964年提出，旨在测试量子理论是否可以被局部隐变量理论所描述。简单来说，贝尔不等式为经典物理和量子力学之间的根本区别提供了一个可检验的数学框架：如果量子力学是正确的，那么在某些实验中，这个不等式会被违反，从而揭示出“非局域性”（non-locality）的存在，即相隔遥远的粒子之间可以存在即时关联。为了深入理解这一点，让我们从贝尔不等式的一个常见变体——CHSH不等式（以Clauser、Horne、Shimony和Holt命名）的推导开始。

首先，假设存在一个局部隐变量 $\lambda$，它遵循某个概率分布 $\rho(\lambda)$，满足 $\int \rho(\lambda) d\lambda = 1$。考虑两个实验者，Alice和Bob，他们分别进行测量：Alice有两个测量设置，记为 $a = 1$ 或 $a = 2$，Bob也有两个测量设置，记为 $b = 1$ 或 $b = 2$。对于每个测量设置，测量结果只能取 $+1$ 或 $-1$。在局部隐变量理论中，Alice的测量结果 $A_a(\lambda)$ 只依赖于她的设置 $a$ 和隐变量 $\lambda$，而Bob的测量结果 $B_b(\lambda)$ 只依赖于他的设置 $b$ 和 $\lambda$，且两者之间没有瞬时相互影响——这就是“局部性”假设。

接下来，我们定义测量结果之间的相关性函数 $E(a, b)$，它表示当Alice使用设置 $a$、Bob使用设置 $b$ 时，他们测量结果的期望乘积：
$$
E(a, b) = \int A_a(\lambda) B_b(\lambda) \rho(\lambda) d\lambda.
$$
这个积分涵盖了所有可能的隐变量 $\lambda$，并加权了它们的概率。

现在，我们构建CHSH值 $S$，它是四个相关性的线性组合：
$$
S = E(1,1) + E(1,2) + E(2,1) - E(2,2).
$$
我们的目标是证明，在局部隐变量理论下，$|S| \leq 2$。为了推导这个不等式，我们首先将 $S$ 用隐变量表示：
$$
S = \int \left[ A_1(\lambda) B_1(\lambda) + A_1(\lambda) B_2(\lambda) + A_2(\lambda) B_1(\lambda) - A_2(\lambda) B_2(\lambda) \right] \rho(\lambda) d\lambda.
$$
注意到括号内的表达式可以重写为：
$$
A_1(\lambda) [B_1(\lambda) + B_2(\lambda)] + A_2(\lambda) [B_1(\lambda) - B_2(\lambda)].
$$
由于 $B_b(\lambda)$ 只能取 $+1$ 或 $-1$，我们分析 $B_1(\lambda) + B_2(\lambda)$ 和 $B_1(\lambda) - B_2(\lambda)$ 的可能值。如果 $B_1(\lambda) = B_2(\lambda)$，那么 $B_1(\lambda) + B_2(\lambda) = \pm 2$，而 $B_1(\lambda) - B_2(\lambda) = 0$；如果 $B_1(\lambda) \neq B_2(\lambda)$，那么 $B_1(\lambda) + B_2(\lambda) = 0$，而 $B_1(\lambda) - B_2(\lambda) = \pm 2$。因此，无论哪种情况，这两个表达式中总有一个为0，另一个的绝对值为2。这意味着：
$$
|A_1(\lambda) [B_1(\lambda) + B_2(\lambda)] + A_2(\lambda) [B_1(\lambda) - B_2(\lambda)]| \leq 2,
$$
因为 $A_a(\lambda)$ 是 $\pm 1$，所以整个表达式的绝对值不会超过2。因此，对于每个 $\lambda$，上述积分内的绝对值上限为2，再乘以概率分布 $\rho(\lambda)$（非负且积分为1），我们得到：
$$
|S| = \left| \int \left[ A_1(\lambda) B_1(\lambda) + A_1(\lambda) B_2(\lambda) + A_2(\lambda) B_1(\lambda) - A_2(\lambda) B_2(\lambda) \right] \rho(\lambda) d\lambda \right| \leq \int \left| \cdots \right| \rho(\lambda) d\lambda \leq 2 \int \rho(\lambda) d\lambda = 2.
$$
因此，我们推导出了CHSH不等式：在局部隐变量理论下，$|S| \leq 2$。然而，在量子力学中，如果使用纠缠粒子，例如处于单态的自旋粒子，我们可以实现 $|S| = 2\sqrt{2} > 2$，从而违反这个不等式。这正好引出了CHSH游戏的概念——一个利用这个不等式来测试量子非局域性的简单实验。

## CHSH游戏

在理解了贝尔不等式的基础上，我们可以将其转化为一个具体的实验游戏——CHSH游戏（以Clauser、Horne、Shimony和Holt命名）。这个游戏是测试量子非局域性的一个简单而强大的工具，它允许我们通过实际操作来验证贝尔不等式是否被违反。下面，我将详细定义CHSH游戏的规则，并给出一个量子方案，展示如何利用纠缠粒子来违反贝尔不等式。

### CHSH游戏的定义
CHSH游戏是一个两人合作游戏，涉及两个远距离的参与者：Alice和Bob。游戏由以下步骤组成：
1. **输入生成**：一个第三方（如裁判）随机生成两个比特 $x$ 和 $y$，其中 $x, y \in \{0, 1\}$，且每个比特以均匀概率（各 $1/2$）独立选择。$x$ 发送给Alice，$y$ 发送给Bob。
2. **输出产生**：Alice和Bob在收到输入后，必须各自产生一个输出比特。Alice的输出记为 $a \in \{+1, -1\}$，Bob的输出记为 $b \in \{+1, -1\}$。注意，在游戏中，输出通常映射到 $\pm 1$ 以便于计算相关性，但也可以使用 $\{0, 1\}$ 并转换；这里我们使用 $\pm 1$ 以保持与贝尔不等式推导的一致性。
3. **获胜条件**：游戏的目标是使Alice和Bob的输出满足特定关系。具体来说，获胜条件基于输入 $x$ 和 $y$：
   - 如果 $x \land y = 0$（即 $x$ 和 $y$ 不同时为1），则要求 $a \cdot b = +1$（即 $a$ 和 $b$ 相同）。
   - 如果 $x \land y = 1$（即 $x = 1$ 和 $y = 1$），则要求 $a \cdot b = -1$（即 $a$ 和 $b$ 不同）。

在经典情况下，如果Alice和Bob只能使用局部隐变量策略（即他们的输出仅依赖于本地输入和共享的隐变量，且没有瞬时通信），那么他们的最大获胜概率是有限的。从第一段的贝尔不等式推导中，我们知道CHSH值 $S = E(1,1) + E(1,2) + E(2,1) - E(2,2)$ 满足 $|S| \leq 2$，其中 $E(a,b)$ 是相关性函数。在CHSH游戏中，如果我们将Alice的测量设置映射为 $x=0$ 对应设置1、$x=1$ 对应设置2，Bob的测量设置映射为 $y=0$ 对应设置1、$y=1$ 对应设置2，那么 $S = E(0,0) + E(0,1) + E(1,0) - E(1,1)$。获胜概率 $P_{\text{win}}$ 与 $S$ 的关系为：
$$
P_{\text{win}} = \frac{1}{2} + \frac{S}{8}.
$$
由于 $|S| \leq 2$，在经典策略下，$P_{\text{win}} \leq \frac{3}{4}$。这意味着，即使Alice和Bob采用最优经典策略，他们也无法超过75%的获胜概率。

### 违反贝尔不等式的量子方案
现在，我们展示一个量子方案，其中Alice和Bob共享纠缠粒子，从而能够以超过75%的概率获胜，违反贝尔不等式。这个方案基于量子力学中的纠缠态和特定测量设置。

1. **共享量子态**：Alice和Bob事先共享一个纠缠态，具体为贝尔态 $|\Phi^+\rangle = \frac{|00\rangle + |11\rangle}{\sqrt{2}}$。这个态是最大纠缠态，意味着Alice和Bob的粒子之间存在强相关性，无论他们相距多远。

2. **测量设置**：根据输入 $x$ 和 $y$，Alice和Bob选择不同的测量基：
   - **Alice的测量**：
     - 如果 $x = 0$（对应设置1），她测量泡利 $Z$ 算符。测量结果为 $|0\rangle$ 时输出 $a = +1$，结果为 $|1\rangle$ 时输出 $a = -1$。
     - 如果 $x = 1$（对应设置2），她测量泡利 $X$ 算符。测量结果为 $|+\rangle = \frac{|0\rangle + |1\rangle}{\sqrt{2}}$ 时输出 $a = +1$，结果为 $|-\rangle = \frac{|0\rangle - |1\rangle}{\sqrt{2}}$ 时输出 $a = -1$。
   - **Bob的测量**：
     - 如果 $y = 0$（对应设置1），他测量在基 $\frac{Z + X}{\sqrt{2}}$（即旋转 $\pi/8$ 的基）。具体地，他测量算符 $B_1 = \cos(\pi/8) Z + \sin(\pi/8) X$。测量结果为特征值 $+1$ 时输出 $b = +1$，特征值 $-1$ 时输出 $b = -1$。
     - 如果 $y = 1$（对应设置2），他测量在基 $\frac{Z - X}{\sqrt{2}}$（即旋转 $-\pi/8$ 的基）。具体地，他测量算符 $B_2 = \cos(\pi/8) Z - \sin(\pi/8) X$。输出映射同理。

3. **计算相关性和获胜概率**：通过量子力学计算，我们可以得到相关性函数 $E(x,y) = \langle a b \rangle$。对于上述方案：
   - $E(0,0) = \cos(\pi/4) = \frac{1}{\sqrt{2}}$
   - $E(0,1) = \cos(\pi/4) = \frac{1}{\sqrt{2}}$
   - $E(1,0) = \cos(\pi/4) = \frac{1}{\sqrt{2}}$
   - $E(1,1) = \cos(3\pi/4) = -\frac{1}{\sqrt{2}}$
   因此，CHSH值 $S = E(0,0) + E(0,1) + E(1,0) - E(1,1) = \frac{1}{\sqrt{2}} + \frac{1}{\sqrt{2}} + \frac{1}{\sqrt{2}} - (-\frac{1}{\sqrt{2}}) = 2\sqrt{2} \approx 2.828$。
   代入获胜概率公式：
   $$
   P_{\text{win}} = \frac{1}{2} + \frac{S}{8} = \frac{1}{2} + \frac{2\sqrt{2}}{8} = \frac{1}{2} + \frac{\sqrt{2}}{4} \approx 0.8536.
   $$
   这明显超过了经典上限 $3/4 = 0.75$，从而违反了贝尔不等式。

这个量子方案生动地展示了量子非局域性：通过共享纠缠态，Alice和Bob能够实现更高的获胜概率，这是任何局部隐变量理论无法解释的。在接下来的部分，我们将探讨CHSH游戏在量子网络中的应用。


## CHSH游戏在量子网络中的设备无关纠缠验证与安全性

量子网络的核心挑战之一是如何在不可信环境中验证远距离节点间是否成功建立了量子纠缠。特别是在使用量子中继器时，中继节点可能存在硬件故障、校准错误甚至恶意行为。CHSH游戏允许通信双方以设备无关的方式验证纠缠的存在和质量。

### 协议建模

考虑一个三节点量子网络场景：
- **诚实方**：节点A（Alice）和节点C（Charlie），遵循协议规则
- **潜在恶意方**：中继节点B（Bob），可能试图欺骗A和C
- **网络拓扑**：A和C通过中继节点B建立连接

**设备无关的CHSH验证协议**流程如下：

1.  **初始化**：在B报告纠缠交换成功后，A和C共享量子态，但不假设其为理想贝尔态 $|\Phi^+\rangle = \frac{|00\rangle + |11\rangle}{\sqrt{2}}$。

2.  **随机挑战**：可信第三方随机生成大量输入比特对 $(x, y)$，其中 $x, y \in \{0, 1\}$，发送给A和C。

3.  **量子测量**：
    - A根据 $x$ 选择测量基：$x=0$ 时测量泡利Z算符，$x=1$ 时测量泡利X算符
    - C根据 $y$ 选择测量基：$y=0$ 时测量 $\frac{Z+X}{\sqrt{2}}$ 方向，$y=1$ 时测量 $\frac{Z-X}{\sqrt{2}}$ 方向
    - 记录测量结果 $a, c \in \{+1, -1\}$

4.  **统计验证**：收集足够数据后，计算CHSH值：
    $$ S = \langle a \cdot c \rangle_{x=0,y=0} + \langle a \cdot c \rangle_{x=0,y=1} + \langle a \cdot c \rangle_{x=1,y=0} - \langle a \cdot c \rangle_{x=1,y=1} $$


#### 安全性证明：恶意中继节点无法伪造成功纠缠

我们将严格证明，即使中继节点B是恶意攻击者，也无法通过任何手段伪造出能够通过CHSH验证的成功纠缠。

**定理**：对于任何策略（经典或量子），如果A和C观测到 $S > 2$，则他们之间必定存在真正的量子纠缠。
##### 情况1：B使用纯经典策略

假设B仅使用经典通信和预处理尝试欺骗。

1. 在经典策略下，B可以预先生成经典相关数据，使用共享随机数等资源
2. 设B的策略由隐变量$\lambda$描述，分布为$\rho(\lambda)$
3. 观测到的相关性为：
   $$E(x,y) = \int A(x,\lambda) C(y,\lambda) \rho(\lambda) d\lambda$$
4. 这正是标准贝尔不等式推导中的局部隐变量模型，因此：
   $$|E(0,0) + E(0,1) + E(1,0) - E(1,1)| \leq 2$$
   即 $S \leq 2$

**结论**：纯经典策略无法产生 $S > 2$ 的CHSH违反。

##### 情况2：B使用量子策略

现在考虑B可以使用任意量子资源。设B制备的初始态为$\rho_{ABC}$，B保留一部分量子系统
由于在CHSH测试期间，A和C的测量是**空间分离**且**同时进行**的，且B无法在测量时刻根据对方的输入调整策略
设A的测量算符为$A_0, A_1$，C的测量算符为$C_0, C_1$，观测态为$\rho_{AC} = \text{Tr}_B(\rho_{ABC})$
如果$\rho_{AC}$是可分离态（无真正纠缠），则可写成：
$$\rho_{AC} = \sum_i p_i \rho_A^i \otimes \rho_C^i$$
对于可分离态，CHSH算符期望值为：
$$\langle S \rangle = \sum_i p_i \left[ \langle A_0 \rangle_i \langle C_0 \rangle_i + \langle A_0 \rangle_i \langle C_1 \rangle_i + \langle A_1 \rangle_i \langle C_0 \rangle_i - \langle A_1 \rangle_i \langle C_1 \rangle_i \right]$$
每个$i$的项都是经典CHSH值，满足 $\leq 2$，因此加权平均也满足：
$$\langle S \rangle \leq \sum_i p_i \cdot 2 = 2$$

因此即使B使用最优量子策略，如果A和C之间没有真正的纠缠，则观测到的CHSH值 $S \leq 2$。

### 一个具体的应用场景
在分布式系统中，多个节点（如服务器或处理器）共享数据，每个节点维护本地缓存。当节点访问共享数据时，需要协调缓存状态以避免数据不一致。考虑两个节点，Alice 和 Bob，它们同时决定是否使自己的缓存无效（输出1）或保持缓存有效（输出0）。输入 $x$ 和 $y$ 表示访问类型：$x=1$ 或 $y=1$ 表示写访问，$x=0$ 或 $y=0$ 表示读访问。

**目标**：
- 如果两个节点都进行写访问（即 $x=1$ 和 $y=1$），则要求至少一个节点使缓存无效（即输出 $a \neq b$），以确保数据一致性（因为同时写可能导致冲突）。
- 如果至少一个节点进行读访问（即 $x=0$ 或 $y=0$），则要求两个节点采取相同的行动（即输出 $a = b$），以简化协议并避免不必要的缓存状态变化（例如，如果两者都使缓存无效，可能增加开销；如果都保持，可能风险较低）。

这个目标直接对应到CHSH游戏的获胜条件：
- 如果 $x = 1$ 和 $y = 1$，则 $a \neq b$。
- 否则， $a = b$。

在经典情况下，使用共享随机性，Alice 和 Bob 无法超过 75% 的获胜概率。而使用量子纠缠，获胜概率可提高到约 85.4%。

#### 经典方法（使用共享随机性）
Alice 和 Bob 可以共享随机比特，但无论采用什么策略，获胜概率最大为 75%。假设输入 $x$ 和 $y$ 是均匀随机的（即每个组合 $(0,0), (0,1), (1,0), (1,1)$ 的概率均为 $1/4$）。

经典最优策略示例：
- Alice 和 Bob 约定总是输出 $a = 0$ 和 $b = 0$（即总是保持缓存）。
  - 当 $(x,y) = (0,0), (0,1), (1,0)$ 时，输出相同，获胜。
  - 当 $(x,y) = (1,1)$ 时，输出相同，但要求不同，失败。
  - 获胜概率： $3/4 = 75\%$。

其他经典策略（如基于共享随机性的条件输出）也无法超过 75% 的获胜概率。

#### 量子方法
Alice 和 Bob 共享一个纠缠态（如贝尔态 $|\Phi^+\rangle = \frac{|00\rangle + |11\rangle}{\sqrt{2}}$），并根据输入选择测量基：
- 如果 $x = 0$，Alice 测量在 Pauli Z 基；如果 $x = 1$，测量在 Pauli X 基。
- 如果 $y = 0$，Bob 测量在基 $\frac{Z+X}{\sqrt{2}}$；如果 $y = 1$，测量在基 $\frac{Z-X}{\sqrt{2}}$。
- 输出 $a$ 和 $b$ 是测量结果（0 或 1）。

计算表明，量子策略的获胜概率为 $\cos^2(\pi/8) \approx 0.854$，即约 85.4%。
