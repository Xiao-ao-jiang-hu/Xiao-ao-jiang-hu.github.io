---
title: On Non-Commutative Routing
tags:
  - non-commutative
  - routing
categories:
  - paper-reading
  - network
  - routing
index_img: /img/reading.jpg
banner_img: /img/reading.jpg
excerpt: 论文阅读
abbrlink: 6a8e9047
date: 2025-11-11 13:48:55
---
https://ieeexplore.ieee.org/document/11044753

## Abs
传统路由代数理论主要研究可交换的路由度量，即路径权重与链路连接顺序无关。然而，在实际应用中，存在许多非交换的路由场景（如端到端重传、协议转换），其路径权重依赖于链路顺序。现有理论缺乏一个统一的框架来解决这类非交换路由问题的可解性、系统化约简和高效算法设计。本文针对非交换路由问题，将路由代数理论扩展以形式化非交换路由问题，并提供了实际案例（如最小化能量的可靠通信、带协议转换的路由）。提出了通用的约简方法，能将非等张的度量通过约简转化为在偏序上的等张形式。具体包括定义了最大左等张约简（GLR） 和最大右等张约简（GRR）。基于此，深入分析了非交换路由问题的可解性，证明了在何种条件下问题是可解或不可解的，以及不同的偏序路由算法是否适用。设计了一种适用于约简后问题的通用链路状态路由算法，该算法在偏序上运行。对其正确性（包括收敛性、无环性和主导性）进行了严格的理论证明。在多种网络拓扑上进行了仿真评估，结果表明该算法高效，且能在链路故障后快速重新计算路由。

## 1. Intro
早期及同期研究为路由代数的理论框架奠定了基础并解决了特定问题。Sobrinho (2003) 在《Network routing with path vector protocols: Theory and applications》中系统阐述了路径向量协议的代数理论，而Yang与Wang (2008) 则明确了多跳无线网络中路由度量的设计准则。这些研究确立了单调性和等张性是确保路由算法收敛与最优的关键性质。对于非等张问题，Lengauer与Theune (1991) 以及Sobrinho与Ferreira (2020) 在后来的工作中引入了等张约简的概念，成功地将特定非等张度量转化为偏序上的等张形式，并扩展了路径向量算法以求解此类问题。此外，众多研究也利用该代数框架对BGP路由（Griffin和Sobrinho, 2005）等具体协议进行了建模与分析。

现有成果存在一个局限：绝大多数工作都默认或依赖于度量具有可交换性这一假设。具体缺陷体现在：首先，少数触及非交换性的研究（如Sobrinho, 2003）仅限于全序场景，未能扩展到更一般的偏序。其次，尽管像Sobrinho与Ferreira (2020) 这样的研究提出了针对非等张代数的约简方法，但他们的方法旨在实现“左等张性”以适配路径向量算法，却未能解决约简对单调性的破坏，而单调性对于链路状态等其它关键算法的正确性至关重要。总而言之，一个能够系统处理非交换代数在通用偏序上所引发问题的完整理论体系仍然缺失。

本论文旨在填补上述研究空白，系统性地解决非交换路由带来的挑战。本文致力于解决三个核心问题：第一，建立一个统一的代数框架，以形式化地描述和定义非交换路由问题。第二，针对非交换特性，提出普适性的左、右等张约简方法，并深入探讨经过约简后问题的可解性，为不同算法（如路径向量、泛洪、链路状态）的适用性提供理论判据。第三，设计一种高效的偏序链路状态算法，该算法能够处理约简后的问题，并严格证明其正确性（包括收敛性、无环性和主导性），最终通过仿真验证其在实际网络中的性能。

## 2. Background
路由代数被定义为一个五元组 $(S, \preceq, L, \oplus, w)$。

1.  权重集合 $(S)$：这是所有可能的路径度量的集合。在最短路径问题中，$S$ 就是所有非负实数的集合（代表路径长度），再加上一个表示“无穷大”的符号 $+\infty$。
2.  偏序关系 $(\preceq)$：这个关系定义了路径之间的优劣比较规则。它不要求集合中所有元素都能两两比较（这正是“偏序”的含义）。对于最短路径问题，偏序 $\preceq$ 就是普通的 $\leq$（小于等于）。$w(a) \preceq w(b)$ 意味着路径 $a$ 优于或等于路径 $b$。
3.  路径集合 $(L)$：这是网络中所有可能路径的集合。
4.  扩展操作 $(\oplus)$：这是一个函数，表示将两条路径连接起来形成一条新路径。例如，如果路径 $a$ 从节点 $u$ 到 $v$，路径 $b$ 从 $v$ 到 $w$，那么 $a \oplus b$ 就是从 $u$ 到 $w$ 的新路径。
5.  权重函数 $(w)$：这是一个函数，为每条路径计算出一个具体的权重值。在最短路径问题中，$w(p)$ 就是路径 $p$ 上所有链路长度的总和。

两个核心性质：单调性与等张性

- 单调性：简单来说，就是“路径只会越变越差”。给任何路径 $l$ 添加一段前缀或后缀，新路径的权重不会比原来的路径更好。
  - 左单调：对于任何路径 $a$，有 $w(a) \preceq w(l \oplus a)$（在 $a$ 前面接上 $l$ 不会让它变好）。
  - 右单调：对于任何路径 $a$，有 $w(a) \preceq w(a \oplus l)$（在 $a$ 后面接上 $l$ 不会让它变好）。
  - 这个性质主要保证了路由过程的收敛性和无环性。如果违反，算法可能陷入无限循环或产生路由环路。

- 等张性：可以理解为“保序性”。如果路径 $a$ 比 $b$ 好，那么在任何上下文（即添加任何前缀或后缀）下，$a$ 依然比 $b$ 好。
  - 左等张：如果 $w(a) \preceq w(b)$，那么对于任何前缀 $c$，都有 $w(c \oplus a) \preceq w(c \oplus b)$。
  - 右等张：如果 $w(a) \preceq w(b)$，那么对于任何后缀 $c$，都有 $w(a \oplus c) \preceq w(b \oplus c)$。
  - 这个性质是保证算法能够找到全局最优路径的关键。如果违反，一个局部看起来好的路径，在组合到更长路径后可能反而变差，导致算法“误入歧途”。

本文的焦点：非交换性

传统理论大多假设度量是可交换的，即 $w(a \oplus b) = w(b \oplus a)$，路径权重与链路顺序无关（如带宽、跳数）。但本文重点研究非交换路由问题，即 $w(a \oplus b) \neq w(b \oplus a)$。

论文中给出两个典型例子：
一是考虑端到端重传的能量最小化路由：由于TCP重传总是由源端发起，数据包在靠近源端的链路上会被传输更多次。因此，路径 `(高丢包率链路 → 低丢包率链路)` 的总能量消耗，与反向路径 `(低丢包率链路 → 高丢包率链路)` 的总能量消耗是不同的。

二是考虑非对等的协议转换路由：在某些网络中，数据包可能需要经过不同的协议转换（如从IPv4到IPv6）。路径 `(IPv4链路 → IPv6链路)` 的总延迟与反向路径 `(IPv6链路 → IPv4链路)` 的总延迟也是不同的，因为每种协议转换的处理时间不同。

在非交换代数中，左和右的性质（如左等张性和右等张性）变得必须严格区分，这使得问题的分析和求解变得异常复杂，也正是本文所要解决的核心挑战。

## 3. Method
### 3.1 通用约简方法：从左/右等张约简到最大约简

#### 解决的问题
现有的等张约简理论主要针对可交换代数。在非交换代数中，左等张性和右等张性不再等价，且针对路径向量算法设计的“左等张约简”会破坏链路状态等算法所必需的单调性。

#### 设计思路与依据
核心洞察是：通过削弱原始偏序，使更多路径权重变得“不可比”，可以消除导致等张性被违反的特定比较。
- 设计依据：如果一个路径 `a` 在原始偏序中比 `b` 好，但在某些上下文（添加前缀或后缀）中反而变差，那么就在新偏序中让 `a` 和 `b` 不可比，从而“掩盖”这个违反等张性的情况。
- 非交换性的影响：由于非交换性，添加前缀（左）和添加后缀（右）的效果不同，因此必须分别定义左等张约简和右等张约简，以分别满足路径向量算法（需要左等张）和链路状态/泛洪算法（需要右等张）的需求。

#### 具体实现

1.  左/右等张约简的定义
    - 定义10 (左等张约简)：一个偏序 $\preceq_{LR}$ 是原始偏序 $\preceq$ 的子关系，它使得代数 $(S, \preceq_{LR}, L, \oplus, w)$ 是左等张的。
    - 定义11 (右等张约简)：一个偏序 $\preceq_{RR}$ 是原始偏序 $\preceq$ 的子关系，它使得代数 $(S, \preceq_{RR}, L, \oplus, w)$ 是右等张的。

2.  最大等张约简的计算
    在所有可能的约简中，最大约简保留了最多的可比性，是最佳选择。论文给出了计算最大约简的定理。

    - 定理12 (最大左等张约简 - GLR)：
      $\forall a,b \in L$, $w(a) \preceq_{GLR} w(b) \iff \forall x \in L, w(x \oplus a) \preceq w(x \oplus b)$
      - 解读：在GLR下，`a` 优于 `b` 当且仅当 在任何前缀 `x` 的上下文中，`x⊕a` 始终不差于 `x⊕b`。

    - 定理13 (最大右等张约简 - GRR)：
      $\forall a,b \in L$, $w(a) \preceq_{GRR} w(b) \iff \forall x \in L, w(a \oplus x) \preceq w(b \oplus x)$
      - 解读：在GRR下，`a` 优于 `b` 当且仅当 在任何后缀 `x` 的上下文中，`a⊕x` 始终不差于 `b⊕x`。

3.  实际计算与简化
    直接应用GLR/GRR的定义需要量化所有路径 `x`，计算上不可行。论文通过具体案例（如MERT）展示了如何利用度量本身的数学性质来推导出等价的、可计算的简化偏序。
    - MERT的简化右等张约简 $\preceq_{RTRR}$:
      $w_3(a) \preceq_{RTRR} w_3(b) \iff (N(a) \leq N(b)) \land (w_3(a) \preceq w_3(b)) \land (w_1(a) \preceq w_1(b))$
      - 设计思路：通过对MERT权重公式 $(2), (3)$ 的分析，发现要保证右等张性，仅比较总权重 $w_3$ 不够，还必须同时保证路径的期望传输次数 `N` 和正向能量消耗 $w_1$ 也具有单调性。这个简化版约简在实践中更容易实现。


### 3.2 约简对代数性质的影响与可解性分析

#### 解决的问题
约简在获得等张性的同时，可能会破坏原有的单调性。必须明确回答：经过GLR或GRR约简后，代数是否还满足特定路由算法所需的基本性质

#### 结论
- 引理14：如果原始代数不满足左（右）单调性，那么任何子关系偏序约简后的代数也不会满足左（右）单调性。
  - 意义：这是一个关键的限制。约简不能创造单调性。如果一个原始问题本身就不单调（可能导致环路），那么约简无法解决这个根本问题。

- 定理16 & 17：总结了GLR和GRR对性质的保持情况。
  - GLR：会保持右单调性和右等张性；但不保持左单调性。不过，如果原始代数本身就是右等张的，那么GLR保持左单调性当且仅当原始代数是右单调的。
  - GRR：会保持左单调性和左等张性；但不保持右单调性。不过，如果原始代数本身就是左等张的，那么GRR保持右单调性当且仅当原始代数是左单调的。

- 表V指明了对于具有不同初始性质的代数，三种路由算法（路径向量、泛洪、链路状态）及其偏序版本在应用GLR/GRR后是否可行。

### 3.3 偏序链路状态算法的设计、正确性与收敛性证明

#### 解决的问题
现有链路状态算法（如Dijkstra）适用于全序，在偏序下会因过早丢弃“局部非最优但全局最优”的路径而失败（如论文图5所示）。需要一个新的、能在偏序下计算所有主导路径的链路状态算法。

#### 算法设计思路
- 核心观察：在偏序下，一个节点的最优路径（主导路径）可能有多条，且它们之间不可比较。传统算法“当前节点”的概念不再适用，应转变为“当前权重”。
- 设计依据：算法必须为每个节点维护一个候选权重集合 $\Pi(v)$，其中存放的是到目前为止发现的、互不支配的到达该节点的路径权重。只有当一条路径的权重被确定为主导权重（即加入已确定集合 $E(s,v)$）后，才用它去更新邻居。

#### 算法实现
输入：网络图，源节点 `s`，路径选择标准（偏序 $\preceq$）。
输出：从 `s` 到所有节点 `v` 的主导权重集合 $E(s,v)$ 和主导路径。
1.  初始化：将所有节点的 $E(s,v)$ 和 $\Pi(v)$ 初始为空，除了源节点 `s` 的 $\Pi(s)$ 包含空路径权重 $w(\epsilon)$。
2.  主循环：当所有候选集合的并集非空时：
    a. 从所有 $\Pi(v)$ 中选出一个全局最小的主导权重 $w(l_{si})$。
    b. 将此权重从 $\Pi(i)$ 移入 $E(s,i)$，标志着它已被确定为从 `s` 到 `i` 的一个主导权重。
    c. 更新邻居：对于 `i` 的每个出边邻居 `j`，计算新路径权重 $w(l_{si} \oplus (i,j))$。然后更新 `j` 的候选集 $\Pi(j)$，使其等于 $\Pi(j) \cup \{\text{新权重}\}$ 的主导集，但要减去已经确定的主导权重 $E(s,j)$（避免重复和回退）。
3. 终止：当所有候选集为空时，每个节点的 $E(s,v)$ 即为从 `s` 到 `v` 的所有主导路径权重。

#### 正确性与收敛性证明

1.  收敛性与无环性 (定理23)
    - 主张：如果网络中所有环路都是严格右单调的，则算法1终止且产生的路由无环。
    - 证明思路：
        - 严格右单调意味着遍历任何环路都会使路径权重严格变差。
        - 由于权重集合是有限的，路径权重不会无限变差。算法在每一步都会选举一个权重并将其最终确定，因此循环必定在有限步内结束。
        - 如果路径包含环路，其权重会比不包含环路的子路径更差，因此在选举过程中会被已有的更好权重所“阻挡”，无法进入候选集，从而保证了无环性。

2.  主导性 (定理27)
    - 主张：如果代数满足右单调性和右等张性，那么算法1稳定后，对于任何节点 `u`，其 $E(s,u)$ 恰好等于从 `s` 到 `u` 的所有主导权重集合 $A^*(s,u)$。
    - 证明思路：通过归纳法和关键引理完成。
        - 引理25：在稳定状态下，$E(s,v)$ 等于其所有入边邻居扩展而来的权重集合 $W(s,v)$ 的主导集。这证明了算法的局部正确性。
        - 引理26：利用右等张性进行归纳，证明对于任意从 `s` 到 `u` 的路径 `l`，在 $E(s,u)$ 中都存在一个主导权重 $a$，满足 $a \preceq w(l)$。这证明了算法结果的全局完备性（没有遗漏任何更好的路径）。
        - 定理27：结合以上引理，最终证明 $E(s,u) = A^*(s,u)$，即算法找到了所有且仅有的主导路径。

