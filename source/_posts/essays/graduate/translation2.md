---
title: translation2
tags:
  - no tags
categories:
  - uncategorized
excerpt: no excerpt
abbrlink: c76cab81
date: 2025-12-23 21:38:16
---
# **保真度感知的多路径路由用于量子网络中的多方态分发**

**作者：** EVAN SUTCLIFFE¹（IEEE会员）和 ALEJANDRA BEGHELLI¹,²（IEEE会员）
¹ 伦敦大学学院电子与电气工程系，伦敦，WC1E 6JE，英国
² BT集团，萨福克郡伊普斯维奇，IP5 3RE，英国

**通讯作者：** Evan Sutcliffe (evan.sutcliffe.20@ucl.ac.uk)。

本工作得到了工程与物理科学研究委员会（资助号 EP/S021582/1）、TRANSNET（EP/R035342/1）和Innovate UK（10004793）的支持。

#### **摘要**
我们考虑了在量子网络中分发纠缠的多方态以提高分发速率和保真度的问题。为此，我们提出了保真度感知的多路径路由协议，评估了这些协议在分发Greenberger-Horne-Zeilinger (GHZ) 态方面的速率和保真度性能，并将其与单路径路由的性能进行了比较。仿真结果表明，所提出的多路径路由协议选择的路径比单路径路由需要更多的贝尔态，但所需的贝尔态生成轮次更少。我们还通过为量子存储器的存储时间选择一个适当的截止值，优化了分发速率与保真度之间的权衡。使用这种截止技术，所提出的多路径协议可以实现比单路径路由高达8.3倍的分发速率提升和高达28%的GHZ态保真度改进。这些结果表明，多路径路由在多方态分发中既能提高分发速率，又能增强保真度。

**索引词：** 量子网络，Greenberger-Horne-Zeilinger (GHZ) 态，量子互联网

### **一、引言**

由能够长距离交换量子信息的设备组成的量子网络，有望在量子信息处理中实现许多应用[1]–[4]。然而，量子比特不应直接长距离传输，因为任何编码的量子信息都很容易因与环境的相互作用而丢失。将量子信息编码到逻辑保护态中可以防止这种情况发生[5]，但使用当前的技术尚不可行[6]。取而代之的是，可以利用共享的纠缠态作为资源来实现量子信息的可靠传输。例如，一个最大纠缠的两量子比特态，如共享的贝尔态，可以通过量子隐形传态[7]来传输单个量子比特的状态。

为了在非相邻节点之间分发贝尔态（也称为二分纠缠），可以使用量子中继器[8]–[11]。对于两个分别与一个中继节点共享贝尔态的设备，可以在这些贝尔态上执行纠缠交换，从而在这两个非相邻设备之间产生一个共享的贝尔态。为了在量子网络中的两个远距离设备之间共享一个贝尔态，可以沿着设备之间的量子中继器路径递归地执行纠缠交换。

虽然在两个设备之间共享量子信息需要访问一个二分态，但多方通信则需要一个共享的多方态。多方态，如Greenberger-Horne-Zeilinger (GHZ) 态和图态，是具有许多潜在用途的多量子比特纠缠态[12]-[20]。特别是GHZ态可用于多方量子密钥分发（QKD）[14], [15]、量子传感[16]、量子纠错[17]–[19]和分布式量子计算[20]–[22]。

为了在非相邻用户之间分发GHZ态，路由是一项必须执行的关键任务。路由是指选择一组用于以最低成本在用户之间分发量子态的设备和信道。我们将这组设备和信道称为路由解决方案。路由方法可分为单路径路由和多路径路由。单路径路由涉及选择一个唯一的预计算路由解决方案。相比之下，在多路径路由中，路由解决方案可以从许多可能的选项中动态选择[23], [24]。当使用多路径路由时，网络会在许多冗余信道上执行贝尔态生成，路由解决方案的选择取决于贝尔态生成的概率性结果。

可以通过选择不同的指标来优化路由。对于具有噪声操作的量子网络，应同时考虑分发态的速率和保真度[10], [25]–[28]，特别是因为许多应用（如量子纠错）对分发态的最小保真度有严格的阈值要求[18], [19], [29]。先前的研究表明，使用多路径路由可以提高分发速率[15], [23], [24], [30]–[33]。然而，迄今为止，多路径路由对分发态保真度的影响尚未被考虑。

我们首次研究了使用保真度感知的多路径路由分发多方GHZ态的问题。我们提出了两种多路径协议，旨在在嘈杂的量子网络中向任意一组节点分发N量子比特的GHZ态。为此，在选择路由解决方案时同时考虑了分发态的速率和保真度。我们还应用了一个截止时间到量子存储器，以控制网络中贝尔态的最小保真度。评估并比较了这些协议实现的分发速率和保真度与等效的单路径路由协议。

本工作的贡献如下：
- 提出了两种利用保真度感知多路径路由的新型多方态分发协议。这些协议利用网络中贝尔态的保真度和位置信息来动态执行路由。
- 首次评估了多路径路由与分发的多方态保真度之间的关系。此外，我们展示了多路径协议在某些情况下可以同时以比单路径路由更高的速率和保真度分发GHZ态。
- 评估了使用多路径路由时内存截止时间的影响。通过选择合适的截止时间，我们展示了如何优化速率与保真度之间的权衡。

本文其余部分安排如下。第二部分回顾了必要的背景文献。第三部分描述了网络模型，以及量子比特错误模型及其对分发态保真度的影响。第四部分介绍了新协议。第五和第六部分分别给出了结果和结论。

### **二、背景**

#### **A. 路由方法及其对分发速率和保真度的影响**

对于单路径路由，路由解决方案是一组用于分发所需态的唯一预计算的节点和信道。在选定的路由解决方案上尝试贝尔态生成，然后用于分发所需的纠缠态。鉴于非局域贝尔态的生成具有概率性，分发速率会随着用户之间的距离以及所需贝尔态的数量而降低[8], [23]。对于多路径路由，路由解决方案是动态选择的，利用了网络中共享贝尔态位置的知识。多路径路由已被证明可以提高二分态和多方态相对于单路径路由的分发速率[23], [24], [30], [31], [33], [34]，即使在测量不完美时也是如此[30], [35]。对于二分态分发，已有工作考虑了通过迭代方法分配多条路径来提高分发态的保真度。为此，在每条路径上分发的贝尔态上递归地执行纠缠提纯[36]。然而，每条路径独立运行，这些工作并未考虑动态路由问题。

对于多方态分发，多路径路由的使用通常侧重于提高分发速率。其中一个关键原因是，当网络中观察到渗透现象时，多路径路由可以实现与距离无关的速率，而单路径路由则无法做到这一点，因为单路径路由的分发速率随距离增加而降低[8], [23], [24], [34]。在概率性网络中，边以固定的概率独立地存在或不存在，长距离连通性由键渗透行为实现。当边（键）存在的概率高于渗透阈值$p_c$时，用户节点位于同一连通分量中的可能性变得与它们之间的距离无关。对于所考虑的方形晶格拓扑，渗透阈值由$p_c = \frac{1}{2}$给出。这种长距离连通性的原因是，在渗透阈值之上，会出现一个跨越网络大部分节点的巨型连通分量，而所有其他连通分量都很小[37], [38]。对于可以使用任何边集的多路径路由，成功分发GHZ态仅要求所有用户节点位于同一个连通分量中，其中边代表节点之间共享的贝尔态。然而，先前关于多路径路由的工作并未考虑其对保真度的影响。

在量子网络中，路由还可以与提高分发态保真度的子程序相结合。例如纠缠提纯[39]–[43]和内存截止[8], [25], [26], [44], [45]。此类子程序可以提高分发态的保真度，但代价是降低了可实现的速率[26], [39]。在纠缠提纯的情况下，从多个该态的含噪副本中生成更高保真度的态。然而，生成多个副本会显著增加分发纠缠态所需的总等待时间。量子内存截止是对量子内存中量子比特最大允许存储时间的限制。可以实施截止来解决由于退相干导致的保真度降低问题。退相干描述了当量子比特存储在含噪量子内存中时，量子信息随时间的丢失。通过利用退相干率的知识，可以选择一个截止值，在态的保真度低于预定阈值时将其丢弃。截止值的选择可以调整以修改速率和保真度之间的权衡。对于单路径路由，可以解析地计算出最佳截止时间[25], [26]。然而，这类工作尚未扩展到多路径路由，后者需要更复杂的解析表达式。

#### **B. 多方态分发**

由于在量子信息应用中的用途，各种工作已经考虑了在量子网络中分发多方态[28], [42], [44], [46]–[49]。其中许多工作的关键主题是在路由解决方案中使用一个中心节点。中心节点可用于在本地生成一个N量子比特的多方态，然后将该态的一个量子比特传送到每个N个用户[46], [48], [50]。在分发GHZ态时，可以使用纠缠融合来简化该方法[30], [42]。在这种情况下，每个用户必须首先与中心节点生成一个共享的贝尔态。如果用户不与中心节点相邻，则可以通过沿着设备路径执行纠缠交换来实现。然后，通过在中心节点存储的贝尔态的量子比特之间执行纠缠融合，可以将这些贝尔态融合成一个在用户之间共享的GHZ态[46]。在这两种情况下，路由解决方案都需要在每个用户和中心节点之间有一条单独的路径。我们将这种路由方法称为星型路由，如图1(a)所示。此外，通过纠缠融合生成GHZ态并不要求所有融合操作都在单个中心节点内执行。在Meignant等人[49]的工作中，展示了如何从连接用户的贝尔态树生成GHZ态，其中在存储多个贝尔态量子比特的节点上执行融合。以最小成本连接一组用户的树是斯坦纳树[51]。图1(b)显示了一个使用斯坦纳树的路由示例，我们称之为树路由[15], [24], [52]。

更一般地，已经考虑了从纠缠融合联合生成和提纯GHZ态的情况，这些情况不需要路由。这类工作考虑了设备相邻或任意连接的情况。此类工作的应用包括分布式量子纠错，其中必须在固定的四台相邻设备之间分发高保真度的GHZ态[18], [19], [42]。虽然这些方案不考虑如何在量子网络中长距离分发态，但此类工作中的技术可以应用于在复杂拓扑结构中任意设备之间共享高保真度的多方态。

#### **C. 多方态分发的路由**

已经研究了用于多方态分发的单路径路由，同时考虑了星型[28], [44], [46], [50]和树形方法[24], [28], [49], [52]。在Bugalho等人[28]的工作中，提出了星型路由方法，Avis等人[46]扩展了这些方法，提出了实现策略以及分发速率和保真度的进一步解析界限。在Avis等人的工作中，假设需要多轮贝尔态生成。对于使用星型方法的方法，已经考虑了内存截止作为一种调整速率和保真度权衡的方法。已经使用蒙特卡洛或马尔可夫链分析对这种截止进行了优化[44], [47], [53]。已将单路径路由应用于选择树形方法的路由解决方案，用于GHZ态分发[28], [52]。

多路径路由同样已被研究用于多方态分发，同时考虑了星型和树形方法。已经表明，多路径路由可以提高在量子网络上共享GHZ态的分发速率[24]。进一步的工作扩展了这一结果，显示了多方QKD密钥速率的提高[15]。然而，多路径路由对分发态保真度的影响尚未被考虑。在需要多轮贝尔态生成的含噪网络中，退相干与多路径路由实现的更高分发速率之间的关系也未被探索。

### **三、网络和错误模型**

我们考虑在量子网络上分发N量子比特多方GHZ态的协议，其定义为 $|\mathrm{GHZ}_N\rangle = \frac{1}{\sqrt{2}}(|0\rangle^{\otimes N} + |1\rangle^{\otimes N})$。此类多方分发协议的性能对网络参数敏感，例如贝尔态可以生成的速率和保真度。接下来，我们定义一个用于协议性能评估的量子网络模型。

#### **A. 网络模型**

量子网络被建模为一个图 $G=(V,E)$，它是由节点 $v \in V$ 和边集 $e \in E$ 连接而成的集合，如图2所示。节点是配备了单个量子内存的设备，每个相邻边都有一个用于通信的量子内存。这些节点可以在量子内存中存储量子比特，并执行单量子比特、双量子比特和测量操作。我们假设所有节点具有相同的能力。一条边代表一个量子信道，可用于在两个相邻节点之间共享一个形式为 $|\phi^{+}\rangle = \frac{1}{\sqrt{2}}(|00\rangle + |11\rangle)$ 的贝尔态。这些共享的贝尔态以下简称为纠缠链路。纠缠链路以概率 $p_e$ 为网络边e生成。我们假设采用一种有标志的纠缠分发方案，使得成功的纠缠链路生成会通过一个经典信号进行标记[54]。鉴于每个边只有一个内存的假设，一条边上最多只能存储一个纠缠链路，并且在内存仍被占用时不能重新尝试纠缠链路生成。我们还定义了一个链路状态图 $G'=(V,E')$，它描述了量子网络上纠缠链路的位置。在 $G'$ 中，当节点u和v共享一个纠缠链路时，边 $e=(u,v)$ 就存在。链路状态图的这个定义意味着 $G'$ 将包含来自 $G$ 的所有节点，即使有些节点不持有任何纠缠链路。在这种情况下，这些节点在 $G'$ 中将是断开连接的。最后，我们将网络的操作建模为在持续时间为 $T_{\mathrm{slot}}$ 的离散时隙中进行。一个时隙包括纠缠链路的生成，以及生成GHZ态所需的任何局域操作和经典通信（LOCC）。我们考虑实现一个量子内存截止。在离散时隙网络模型中，截止值 $Q_c$ 定义了在丢弃之前，纠缠链路可以在量子内存中存储的最大时隙数。随着网络在多个时隙上运行，我们使用索引 $t \in \{1,2,\ldots\}$ 来表示第 $t$ 个时隙。在离散时间网络模型中，一个周期为 $T_{\mathrm{slot}}$ 的时隙有时被称为一轮。在此上下文中，k轮指的是一组k个有序的连续时隙。最后，由于 $G'$ 的状态在时隙之间会变化（因为纠缠链路被生成和丢弃），我们定义了一个链路状态图 $G'_t$，它表示在时隙 $t$ 期间 $G'$ 的状态。

#### **B. 错误模型**

我们在一个由含噪量子设备组成的网络中考虑多方态分发，其中不完美的贝尔态生成和退相干是主要的错误来源。我们假设LOCC操作是瞬时且理想的，这意味着分发的GHZ态中的任何噪声都可以归因于用于分发的贝尔态中的噪声。LOCC操作的例子包括纠缠交换和纠缠融合。我们通过它们的保真度来量化噪声对分发态的影响。保真度 $\mathcal{F}$ 是衡量两个量子态重叠程度的指标，范围为 $0 \leq \mathcal{F} \leq 1$。对于一个混合态 $\rho$（例如在含噪条件下生成的态），保真度可以相对于一个期望的纯态 $|\Psi\rangle$ 定义为：
$$\mathcal{F}(\Psi, \rho) = \langle\Psi|\rho|\Psi\rangle$$

我们使用去极化噪声信道[55]来建模量子噪声，该信道已被证明是量子网络中噪声的良好模型，并且可以被视为最坏情况的错误信道[56]。对于一个维度为 $d=2^N$ 的N量子比特混合态 $\rho$，N量子比特去极化信道将该态变换为：
$$\mathcal{D}(\rho) = p_n \rho + \frac{(1-p_n)}{2^N} \mathbb{I}_d.$$
这相当于以概率 $p_n$ 保持态不变，并以概率 $1-p_n$ 将态变换为最大混合态 $\mathbb{I}_d/d$。这里 $\mathbb{I}_d$ 是d维单位矩阵，最大混合态 $\mathbb{I}_d/d$ 代表了关于先前量子态信息的完全丢失。在含噪条件下分发的纠缠链路，其去极化噪声效应可以用维尔纳态[7]来描述：
$$\rho_w = w |\phi^{+}\rangle\langle\phi^{+}| + \frac{1-w}{4} \mathbb{I}_4.$$
维尔纳态是一个混合态，它由理想贝尔态以概率 $w$ 组成，由最大混合态以概率 $1-w$ 组成。维尔纳态相对于期望贝尔态的保真度可以用维尔纳参数w表示为 $\mathcal{F} = \frac{3w+1}{4}$ [7]。

除了在纠缠链路生成期间建模噪声外，还可以使用维尔纳态来量化将纠缠链路存储在含噪量子内存中的效应[25], [26]。一个维尔纳态在两个不完美内存中存储时间t后，其维尔纳参数为 $w_t = w_0 e^{-t/T_c}$，其中 $T_c$ 是贝尔态退相干时间的度量，$w_0$ 是由于含噪纠缠链路生成而在时间 $t=0$ 时的初始w值。对于离散时隙网络模型，此表达式可以使用维尔纳态的年龄 $\tau$ 和一个组合的退相干常数 $\Delta = e^{-T_{\mathrm{slot}}/T_c}$ 重写为：
$$w_\tau = w_0 \Delta^\tau$$
退相干常数 $\Delta$ 也代表了维尔纳态中的两个量子比特在时间段 $T_{\mathrm{slot}}$ 内不受单量子比特去极化噪声影响的概率（例如，$1-\Delta = (1-p_n)^{1/2}$）。因此，$\Delta$ 将是退相干率和时隙长度的函数。维尔纳态的年龄 $\tau \in \{0,1,\ldots\}$ 定义为该态在内存中存储的时隙数（自生成以来）。它是通过计算当前时隙的索引与该态生成时隙的索引之差得到的。对于给定的最小贝尔态保真度，可以使用公式(4)计算出一个合适的截止值 $Q_c$，以便在态的保真度低于阈值时将其丢弃。然而，较小的截止值 $Q_c$ 也会降低端到端的分发速率[8]。

#### **C. GHZ态生成与保真度**

在量子网络上分发一个多分GHZ态首先需要在用户之间生成一组贝尔态（纠缠链路）。然后，可以使用LOCC将这些贝尔态组合成所需的GHZ态。因此，分发态的保真度将是所消耗贝尔态保真度的函数，也是交换和融合操作具体配置方式的函数。虽然我们假设这些LOCC操作是理想执行的，但也可以通过考虑对贝尔态施加额外噪声[28]或进行数值模拟来对非理想LOCC操作进行建模。

纠缠交换是一种操作，可用于在未通过量子信道连接的两个节点之间生成共享的贝尔态。图3(a)展示了如何由一个量子中继器执行纠缠交换。如果两个端节点A和C都与一个中间中继器节点B共享一个贝尔态，那么通过对中继器节点持有的量子比特执行贝尔态测量（BSM），就会生成一个在节点A和C之间共享的贝尔态。通过沿着量子中继器路径递归地执行纠缠交换，这种方法可用于在量子网络中的任意两个节点之间分发一个贝尔态[8], [10]。

如果使用含噪贝尔态执行纠缠交换，则分发给端节点的态也会受到噪声的影响。对于在维尔纳态 $w_1$ 和 $w_2$ 上执行的纠缠交换，输出的态也将是一个维尔纳态，其 $w_{\mathrm{out}} = w_1 \cdot w_2$。对于维尔纳态，在执行纠缠交换时，去极化噪声的效应可以相乘地组合[25]。这种关系可以扩展到沿着量子中继器路径执行的纠缠交换。在端节点之间分发的态将具有维尔纳参数：
$$w_B = \prod_{e \in B} w_e$$
其中 $w_e$ 表示在边e上持有的维尔纳参数，$B$ 表示一条路径，它可以是路由解决方案中的一条分支。在星型路由解决方案中，分支是中心节点与每个用户节点之间的路径。在树形路由解决方案中，分支是用户节点与分叉节点之间的路径集。分叉节点是斯坦纳树中节点度 $\geq 3$ 的节点。分支在其端点之外不包含用户节点或分叉节点。通过在分支上执行纠缠交换分发的贝尔态的保真度由 $\mathcal{F}_B = (3w_B + 1)/4$ 给出。

纠缠融合可用于将两个分别为 $n_1$ 和 $n_2$ 量子比特的GHZ态组合成一个 $(n_1 + n_2 - 1)$ 量子比特的GHZ态[18], [42], [57]。纠缠融合是LOCC操作的一个例子，因此需要至少一个每个GHZ态的量子比特位于同一个节点中。

图3(b)展示了如何通过融合两个贝尔态来生成一个3量子比特的GHZ态。通过纠缠融合在两个含噪GHZ态之间生成的GHZ态的保真度将取决于噪声和用于融合操作的量子比特的选择。使用星型方法分发的GHZ态的保真度 $\mathcal{F}_{\mathrm{GHZ}}$ 可以表示为待融合的贝尔态 ${\mathcal{F}}_B$（每个分支B一个）的保真度的函数[28]：
$$\begin{aligned}
\mathcal{F}_{\mathrm{GHZ}} = & \frac{1}{2} \left( \prod_{B \in R} \frac{4\mathcal{F}_B - 1}{3} + \prod_{B \in R} \frac{2(1 - \mathcal{F}_B)}{3} \right. \\
& \left. + \prod_{B \in R} \frac{1 + 2\mathcal{F}_B}{3} \right)
\end{aligned}$$
此表达式假设要分发的态在 $|S| > 2$ 个用户之间，因此R中有多个分支。类似地，对于从贝尔态树生成的GHZ态，GHZ态保真度也有一个解析描述，其中包含依赖于树中贝尔态的保真度和排列的递归项[28]。

GHZ态分发的最后一项操作是量子比特移除。可以通过对要移除的量子比特执行X基测量来从GHZ态中移除一个量子比特，而不会破坏剩余量子比特之间的纠缠。假设此操作是理想执行的，则对剩余GHZ态的保真度没有影响。

### **四、保真度感知的多方分发协议**

在本节中，我们提出了用于以保真度感知方式在量子网络中分发多方GHZ态的多路径路由协议。这些协议旨在在一组用户S（它是来自第三节所述网络图G的节点子集 $S \subseteq V$）之间分发一个GHZ态。我们假设用户希望共享一个单一的N量子比特GHZ态，使得每个 $s \in S$ 获得GHZ态的一个量子比特（$|S| = N$）。首先，我们从三个不同阶段（路由、纠缠链路生成和GHZ态生成）的角度描述一个通用的多方分发协议，然后介绍所提出协议的具体内容。

#### **A. 多方态路由**

我们考虑使用第二节中介绍的星型或树形方法的多方态分发协议。对于每种方法，我们将路由解决方案R定义为G的一个子图，其中在分发GHZ态之前，每条边都必须持有一个纠缠链路（$R \subseteq G'$）。对于星型路由方法，R由中心节点 $v_c$ 与每个用户 $s \in S$ 之间的一组路径（分支）组成，这些路径在 $G'$ 中是边不相交的。对于树形路由方法，R可以是连接用户的任何树。星型和树形路由问题的形式化描述见附录A。

选择R的主要目标是通过选择具有最高成功生成R中所有所需纠缠链路概率的边来最大化分发速率[8]。这可以通过选择最大化 $p_R$ 的路由解决方案R来实现。
$$p_R = \prod_{e \in R} p_e$$
可以通过使用边参数的对数作为权重（例如 $c_e = -\log(p_e)$）并结合标准路由算法（如Dijkstra最短路径[58]、最小成本最大流[59]或斯坦纳树算法[51]）来找到最大化 $p_R$（或任何乘法成本函数）的路由解决方案。

选择最大化GHZ态保真度的路由解决方案更为复杂。确切的GHZ保真度将非线性地依赖于R中每个分支上每个贝尔态的保真度。这意味着直接针对GHZ态保真度优化来选择R，特别是对于树形路由方法，会使直接优化在计算上不可行。计算斯坦纳树的标准方法假设线性成本的边权重，这已被证明是NP难的，因此任何直接优化保真度的计算难度至少与此相当。因此，我们使用一个保真度下界 $\mathcal{F}_{LB}$（$\mathcal{F}_{GHZ} \geq \mathcal{F}_{LB}$）作为可以高效优化的代理：
$$\mathcal{F}_{LB} = \prod_{e \in R} \mathcal{F}_e$$
该下界源于这样一个事实：边e上的维尔纳态的保真度 $\mathcal{F}_e$ 也等于它处于期望的 $|\phi^{+}\rangle$ 态的概率[7]。因此，$\mathcal{F}_{LB}$ 的值表示R中所有维尔纳态都处于 $|\phi^{+}\rangle$ 态的概率，这将导致生成的GHZ态的保真度至少为 $\mathcal{F}_{LB}$ [43]。我们还考虑了项 $w_R$，它是来自R的维尔纳参数的乘积：
$$w_R = \prod_{e \in R} w_e$$
对于维尔纳态，$\mathcal{F}$ 和w之间的关系由 $\mathcal{F} = (3w+1)/4$ 给出。由于 $\mathcal{F}$ 和w之间的变换是仿射的（线性加常数）且单调的，并且假设 $w \in [0,1]$，因此使用 $w_e$ 或 $\mathcal{F}_e$ 进行路由将选择相同的最优路由解决方案R来最大化 $\mathcal{F}_{LB}$。因此，可以使用标准路由技术，以边权重 $c_e = -\log(w_e)$ 来最大化 $\mathcal{F}_{LB}$。由于 $\mathcal{F}_e \geq w_e$，我们还可以进一步说 $\mathcal{F}_{LB} \geq w_R$。关于保真度下界的动机和准确性的进一步讨论见附录B，其中我们展示了下界与精确GHZ态保真度之间的平均差异小于1.1%。

#### **B. 纠缠链路生成**

由于纠缠链路生成是概率性的，可以在多轮中重新尝试，直到生成所有所需的贝尔态。此过程在为多方态分发选择的图的边子集上执行。在生成纠缠链路后，它被存储在含噪量子内存中，在此期间它经历退相干，使用其维尔纳参数 $w_e$ 建模，如公式(4)所述。由于使用了截止值（$Q_c$ 个时隙），在纠缠链路存储了 $\tau_e \geq Q_c$ 个时隙后，它将被丢弃。鉴于每个节点为每个网络边分配一个用于通信的量子内存的假设，一旦在一条边上生成了纠缠链路，在它被消耗或丢弃之前，无法在该边上重新尝试纠缠链路生成。

#### **C. GHZ态生成**

我们描述了一种从量子网络上共享的贝尔态树或星型结构生成GHZ态的方法。然而，也可以使用其他等效方案[46], [49]。一旦选择了路由解决方案，分发GHZ态的方式对于单路径和多路径路由方法都是相同的。所提出的方案假设一个树形布局，但由于所有星型拓扑也是树，因此该方案对星型和树形方法都有效。图4展示了如何使用所描述的操作将纠缠链路树转换为在用户之间共享的GHZ态。首先通过在树的任何分支上执行纠缠交换来简化路由解决方案R。这导致在每个分支端点的节点之间共享一组贝尔态。这些节点将是用户节点以及路由解决方案的任何分叉节点。然后，在此简化树中持有多个贝尔态量子比特的所有节点上执行纠缠融合。在执行纠缠融合操作后，已经生成了一个在用户和分叉节点之间共享的GHZ态。最后一步是通过对分叉节点持有的GHZ态的任何量子比特执行X基测量来移除它们。最终的态，经过局域校正后，是在用户集S之间共享的N量子比特GHZ态，使得每个用户持有GHZ态的一个量子比特。量子比特移除是一个可选操作，可用于确保分发的态恰好是在用户节点S之间共享的N量子比特GHZ态。否则，分发的态将是一个更大的GHZ态，其量子比特也由“分叉”节点持有。对于某些应用，更大的GHZ态不是问题，但对于其他应用（如QKD），这是不可接受的。

#### **D. 基准和所提出的协议**

我们描述了四种多方纠缠分发协议。其中两种是用于基准测试的基线协议，它们利用单路径星型（sp-s）和树形（sp-t）方法。另外两种是使用保真度感知多路径路由的新协议。描述了所提出的多路径路由方法的星型（mp-s）和树形（mp-t）变体。单路径星型协议改编自[28], [46]中描述的在含噪量子网络中分发GHZ态的工作。类似地，单路径树形协议是考虑斯坦纳树进行路由的单路径方法的推广[24], [28], [44], [52]。基准单路径协议被设计为在与所提出的多路径协议相同的条件下运行，不包括路由。虽然可以将更先进的技术与路由结合用于分发纠缠态，但这允许对路由方法进行直接比较。对于多路径协议（mp-s和mp-t），协议需要知道链路状态图 $G'$ 才能进行路由。在中央控制器处获取 $G'$ 的状态将需要额外的经典通信。由于这种额外经典通信导致的任何延迟都会由于退相干而影响分发态的保真度。然而，对于某些量子比特技术和中等规模的量子网络（如量子数据中心），延迟要求应该不显著。延迟对纠缠分发协议的影响是一个重要的研究领域，但超出了本工作的范围。

**1) 基准单路径协议**

单路径星型（sp-s）和单路径树形（sp-t）协议是分别使用星型和树形路由方法的基准单路径协议。sp-s协议的路由解决方案R由从中心节点 $v_c$ 到S中每个用户 $s \in S$ 的一组路径组成。这些路径在链路状态图 $G'$ 中必须是边不相交的。对于sp-t协议，路由解决方案是连接S的斯坦纳树。图1显示了sp-s和sp-t的路由解决方案示例。星型和树形协议使用的路由方法的形式化定义见附录A。为了进行基准测试，我们在具有统一边参数 $(p_e, w_0, \Delta, Q_c)$ 的网络G中模拟这些协议。这确保了单路径路由解决方案对于分发速率和保真度都是最优的，因为任何最大化速率的路由解决方案也将最大化保真度。

**算法1 单路径路由（星型/树形）**
```
function SINGLEPATHROUTING(G, S, type)
    G′ ← (V, ∅)
    (R, vc) ← GetRoutingSolution(G, S, type)
    t ← 0
    repeat
        t ← t + 1
        G′ ← DiscardCutoff(G′)
        G′ ← EntanglementLinkGeneration(R, G′)
        if R ⊆ G′ then
            GHZ ← GenerateGHZFromRoutingSolution(G′, R, S)
            return GHZ
        end if
    until GHZ state successfully generated
end function
```
这些协议以伪代码形式一起描述在算法1中。这两个协议具有相似的操作，因此一起描述，路由条件由变量 $\mathrm{type} \in \{\mathrm{star}, \mathrm{tree}\}$ 区分。最初，从G中选择路由解决方案R，以最大化分发速率和保真度，如函数GetRoutingSolution所示。GetRoutingSolution函数代表附录A中形式化描述的路由算法，用于选择最优的单路径星型或树形路由解决方案。sp-s协议还需要选择一个中心节点 $v_c$。由于假设网络中的所有节点都具有同等能力，任何节点都可以作为中心节点。因此，为每个节点 $v \in V$ 作为中心节点计算最优路由解决方案R。在这些候选解决方案中，选择使速率和保真度最大化的 $(R, v_c)$ 对。

一旦选择了R，网络的时间演化就开始了。时隙t中的链路状态图 $G'$ 描述为 $G'_t$。在每个时隙开始时，丢弃年龄超过截止值的纠缠链路（DiscardCutoff），然后尝试纠缠链路生成（EntanglementLinkGeneration）。这些函数对网络节点的操作进行建模，并在算法2和3中进一步描述。截止值 $Q_c$ 被定义为G上的一个边参数，但在第五节中我们假设它是统一的。然后，在路由解决方案R中每条尚未持有纠缠链路的边 $e \in R$ 上尝试纠缠链路生成，生成成功与否由纠缠链路生成概率 $p_e$ 采样，描述为函数GenerateLinkSuccess。如果R中的所有边都持有纠缠链路（$R \subseteq G'_t$），则生成一个GHZ态（GenerateGHZFromRoutingSolution）。此函数代表第四节-C中描述的操作，从一组贝尔态生成共享的GHZ态。如果无法生成GHZ，则协议进入下一个时隙，直到成功生成GHZ态。虽然没有在特定时间窗口内成功分发的隐式保证，但假设协议会一直持续到成功分发GHZ态。

在通过蒙特卡洛模拟评估协议时，引入了一个额外的参数 $t_{\mathrm{max}}$ 来限制模拟运行时间。如果在 $t_{\mathrm{max}}$ 个时隙内未成功生成GHZ态，则将该次运行标记为失败。选择 $t_{\mathrm{max}}$ 的值要远大于预期的时隙数，以确保分发速率的准确收敛。这是采样方法的一个特征，而不是协议本身的特征，因此在伪代码中被排除。此外，出于这个原因，$t_{\mathrm{max}}$ 不打算作为一个参数来调整以修改协议的行为。

**算法2 使用固定截止值丢弃纠缠链路**
```
function DISCARDCUTOFF(G′)
    for all e ∈ G′ do
        if τe ≥ Qc(e) then
            Remove e from G′
        end if
    end for
    return G′
end function
```

**算法3 纠缠链路生成，其中 $R \subseteq G$ 可以代表一个路由解决方案（单路径）或整个图G（多路径），具体取决于协议。**
```
function ENTANGLEMENTLINKGENERATION(R, G′)
    for all e ∈ R do
        if e ∉ G′ and GenerateLinkSuccess(e) then
            Add e to G′
        end if
    end for
    return G′
end function
```

**2) 多路径协议**

所提出的保真度感知多路径协议是多路径星型（mp-s）和多路径树形（mp-t）协议。图5显示了mp-s和mp-t协议的路由解决方案示例。在这里，路由解决方案是从 $G'$ 中选择的。这种方法不一定能给出与在G中执行路由相比最优的路由解决方案。但是，如果存在有效的路由解决方案，它可以立即使用。

这些协议的操作在算法4中描述，其中星型或树形路由条件由变量type表示。对于多路径协议，在时间演化之前唯一需要的任务是为mp-s协议选择一个中心节点 $v_c$。中心节点 $v_c$ 使用与sp-s协议相同的方法选择，但如果多个候选中心节点给出相同的成本，则选择 $v_c$ 为S的质心。我们假设中心节点是固定的，但它也可以动态选择。

在时间演化中，首先应用内存截止（DiscardCutoff），然后尝试纠缠生成（EntanglementLinkGeneration）。对于多路径路由，在G中所有尚未持有纠缠链路的边上尝试纠缠链路生成。然后，检查RoutingFeasible以评估是否可以分发GHZ态。对于mp-s协议，只要 $G'$ 中 $v_c$ 和S之间的最小割超过 $|S|$，就存在从 $v_c$ 到每个 $s \in S$ 的一组边不相交路径[59]。对于mp-t协议，只要所有用户 $s \in S$ 在 $G'$ 的同一个连通分量中，就可以找到一个跨越S的斯坦纳树。如果路由可行，则从 $G'_t$ 中选择R，使用GetMultipathRoutingSolution以最大化GHZ态保真度。GetMultipathRoutingSolution函数代表附录A中描述的路由算法，应用于多路径路由问题。也就是说，从链路状态图 $G'$ 中选择最优的星型或树形路由解决方案。通过在 $G'$ 上执行路由，可以选择路由解决方案来最大化GHZ态保真度，利用 $G'$ 中纠缠链路的位置和保真度知识，而不是在路由离线执行时必须考虑分发速率和保真度的联合优化。从R的纠缠链路使用第四节-C中描述的从贝尔态生成GHZ态的方法分发GHZ态。如果路由不可行，协议将进入下一个时隙。

我们最初还考虑了利用n量子比特融合操作（GHZ基投影测量）在网络中每个节点持有的所有贝尔态的量子比特之间进行的多路径路由协议[30], [60]。此类协议通过融合网络中的所有纠缠链路来运行，而不是仅沿选定的路由解决方案进行。这种方法的好处是它们可以仅使用本地链路状态信息来执行。然而，我们发现，当贝尔态在去极化噪声存在下分发时，与所提出的多路径协议相比，此类方法实现了更差的分发速率和保真度。此类方法的相对性能在附录C中讨论。

**算法4 多路径路由（星型/树形）**
```
function MULTIPATHROUTING(G, S, type)
    G′ ← (V, ∅)
    vc ← None
    if type == star then
        (_, vc) ← GetRoutingSolution(G, S, type)
    end if
    t ← 0
    repeat
        t ← t + 1
        G′ ← DiscardCutoff(G′)
        G′ ← EntanglementLinkGeneration(G, G′)
        if RoutingFeasible(G′, S, type) then
            R ← GetMultipathRoutingSolution(G′, S, vc, type)
            GHZ ← GenerateGHZFromRoutingSolution(G′, R, S)
            return GHZ
        end if
    until GHZ state successfully generated
end function
```

#### **E. 计算复杂度**

表1描述了路由协议的计算复杂度。为此，我们将在纠缠链路生成开始之前执行的任务（离线任务）和每个时隙执行的任务（在线任务）分开。单路径协议执行的离线任务是预先确定的路由解决方案R的计算。对于sp-s协议，使用最小成本最大流算法（复杂度为 $O(|V||E|^2)$）计算路由解决方案，最多重复 $|V|$ 次，每个候选中心节点 $v_c \in V$ 一次[61]。对于sp-t协议，可以使用斯坦纳树路由算法计算路由解决方案。虽然这是一个NP难问题，但可以使用具有有界精度的近似方法以 $O(|E|\log|V|)$ 的复杂度求解[51]。对于这两种单路径协议，在线（每个时隙）的复杂度为 $O(|R|)$，因为唯一需要的操作是检查R中的所有边是否都持有纠缠链路（$R \subseteq G'$）。

多路径方法对离线任务的要求降低了。mp-s协议需要离线选择一个中心节点，其执行方式和复杂度与sp-s协议相同。mp-t协议具有恒定时间的离线任务，其复杂度为 $O(1)$。与单路径方法相比，多路径路由协议需要更复杂的在线（每个时隙）操作。对于mp-s协议，所需的在线任务是使用最大流方法以 $O(|V||E|^2)$ 的复杂度计算星型路由解决方案[61]。类似地，mp-t协议每个时隙的计算复杂度是求解近似斯坦纳树问题的复杂度。

所描述的路由算法在选择最优路由解决方案以最大化GHZ态保真度时计算并利用保真度下界 $\mathcal{F}_{LB}$。如果需要，可以以线性复杂度 $O(|R|)$ 计算任意路由解决方案R的保真度下界。

**表1：离线和在线路由算法的计算复杂度**

$$
\begin{array}{|l|l|l|}
\hline
\text{协议} & \text{离线计算复杂度} & \text{在线计算复杂度} \\
\hline
\text{sp-s} & O(|V|^2|E|^2) & O(|R|) \\
\text{sp-t} & O(|E|\log|V|) & O(|R|) \\
\text{mp-s} & O(|V|^2|E|^2) & O(|V||E|^2) \\
\text{mp-t} & O(1) & O(|E|\log|V|) \\
\hline
\end{array}
$$

### **五、结果**

本节介绍了第四节中提出的协议的性能评估。根据GHZ态分发速率和保真度对协议进行了评估。结果是通过蒙特卡洛模拟生成的。

#### **A. 性能指标和模型参数**

分发速率是用户之间共享GHZ态的速率。对于离散时间网络模型，分发速率（$\lambda$）可以定义为分发一个GHZ态所需的期望轮数 $\mathbb{E}[T]$（每轮长度为 $T_{\mathrm{slot}}$）的倒数：
$$\lambda = \frac{1}{\mathbb{E}[T]}$$
考虑的第二个指标是保真度，它量化了噪声对分发态的影响。对于由混合态 $\rho$ 描述的含噪GHZ态，保真度 $\mathcal{F}_{\mathrm{GHZ}}$ 可以相对于期望的GHZ态定义为[55]：
$$\mathcal{F}_{\mathrm{GHZ}} = \langle\mathrm{GHZ}_N|\rho|\mathrm{GHZ}_N\rangle$$
在模拟中，通过使用NetSquid[62]实现第四节-C中描述的方法来计算保真度。这些值也通过解析表达式[28]进行了验证。

模拟在一个 $6\times6$ 的方形网格拓扑上进行，随机选择 $|S|=4$ 个节点的子集 $S \subseteq V$，需要共享4量子比特的GHZ态。我们只考虑网格拓扑，但所描述的协议适用于任何网络拓扑。每次模拟运行都是独立的，尝试多轮纠缠链路生成（时隙），直到分发一个GHZ态并且协议终止。每个数据点重复并平均了100个随机选择的用户集S。对于每个S，模拟运行直到分发了300个GHZ态，或最多运行 $3\times10^6$ 个总时隙，以先发生者为准。这是通过为每次运行设置 $t_{\mathrm{max}}=10^4$ 实现的。虽然 $t_{\mathrm{max}}$ 的选择相对于分发GHZ态所需的期望时隙数来说很大，但分发统计数据将取决于用户的位置和底层网络拓扑。如果100个S集中有一个实现了零次成功的GHZ态分发，或者总共分发的成功GHZ态少于200个，则不显示该数据点。

表2概述了模拟中使用的默认参数。当使用非默认值时，会在结果中指定。纠缠链路生成概率p是在一个时隙内生成纠缠链路的概率，假设对所有边都是统一的（$p_e = p, \forall e \in E$）。我们假设一个默认值 $p=0.1$，该值被认为在近期量子设备上是可行的[17]。初始维尔纳参数 $w_0$ 和退相干常数 $\Delta$ 描述了网络中纠缠链路的噪声影响。$w_0=0.987$ 和 $\Delta=0.99$ 的值是由Saha等人[54]的实验结果所启发的，他们在该实验中在单独设备中的囚禁离子量子比特之间生成了贝尔态。实现了 $\mathcal{F}=0.97$ 的贝尔态保真度，并声称随着硬件的改进，$\mathcal{F}>0.999$ 将是可以实现的。受这些结果的启发，我们假设贝尔态以 $\mathcal{F}=0.99$（$w_0=0.987$）的保真度生成。$\Delta=0.99$ 的值是基于实验性的贝尔态生成系统选择的，以反映近期量子网络的典型退相干率[4], [54]。我们对量子内存截止 $Q_c$ 的实现进行了建模，该截止在网络中所有量子内存上是统一的。我们考虑了 $Q_c \in [1,20]$ 范围内的截止值，其中 $Q_c=1$ 的截止值表示如果无法分发GHZ态，则在每个时隙结束时丢弃纠缠链路。

**表2：网络参数默认值。前四个参数定义了量子网络，后两个描述了协议配置。**

$$
\begin{array}{|l|l|l|}
\hline
\text{参数} & \text{默认值} & \text{描述} \\
\hline
G & 6 \times 6 \text{ grid} & \text{网络图：描述网络拓扑的图。默认图为方形网格，} |\overset{\cdot}{E}|=\overset{\sim}{60}, |V|=3\overset{\sim}{6}. \\
p & 0.1 & \text{纠缠链路生成概率：在边上两个相邻节点之间生成贝尔态的概率。} \\
w_0 & 0.987 & \text{维尔纳参数：定义纠缠链路在无去极化噪声情况下生成的概率。} \\
\Delta & 0.99 & \text{退相干常数：纠缠链路在量子内存中存储时不受去极化影响的概率。} \\
S, Q_c & |S|=4, [1,20] & \text{用户：需要共享N量子比特GHZ态的节点集。每个用户集S从V中随机选择。内存截止时间：在丢弃之前纠缠链路存储的最大时隙数。} \\
\hline
\end{array}
$$

#### **B. 分发速率和保真度的权衡**

图6显示了协议实现的分发速率和保真度。每个数据点显示了在100个用户集配置 $S \subseteq V$（其中 $|S| = 4$，每个S从V中随机选择）上实现的平均速率和保真度。对于每个协议，模拟针对一组截止时间 $Q_c \in [1,20]$ 重复进行，$Q_c$ 的值在数据点上标注。扫描 $Q_c$ 显示了增加截止值如何导致以更高的速率分发GHZ态，但保真度降低。可以观察到帕累托前沿，这表明mp-t协议在模拟网络中表现最佳。将表现最好的多路径协议（mp-t）与表现最好的单路径协议（sp-t）进行比较，多路径路由使分发速率提高了高达8.3倍，GHZ态保真度提高了高达28%。分发速率（或保真度）的改进是通过比较mp-t和sp-t协议之间分发速率的最大改进来计算的，前提是mp-t协议的另一个参数（例如保真度（或速率））等于或优于sp-t协议。最大分发速率加速是在将mp-t协议与 $Q_c=13$ 的sp-t协议进行比较时实现的，而保真度改进是在与 $Q_c=20$ 的sp-t协议进行比较时实现的。

在比较星型方法（mp-s和sp-s）时，我们看到mp-s协议实现了高达2.2倍的分发速率改进和16%的保真度改进。此外，我们看到，对于单路径和多路径路由，树形方法（sp-t和mp-t）的表现优于星型方法（sp-s和mp-s）。由于树形方法选择了成本最低的路由解决方案，根据定义，树形方法选择了能提供更高分发速率和保真度的路由解决方案。这是因为星型路由解决方案是有效的，但不一定是最佳的树形解决方案。在附录D中发现的不同纠缠链路生成概率 $p \in \{0.2, 0.3\}$ 的结果显示出相同的总体趋势。

我们专注于规则网格晶格形式的拓扑。然而，所描述的协议可以在任何网络拓扑上运行，包括随机拓扑，如Erdos-Rényi图。所考虑的多路径路由协议在具有许多替代路径且用户之间平均路径长度较低的网络拓扑中表现更好。

#### **C. 路由解决方案大小和纠缠链路年龄**

分发的GHZ态的保真度取决于所需纠缠链路的数量及其保真度。为了量化这一点，我们考虑了路由解决方案 $w_R$ 上去极化噪声的影响如何分离为贝尔态生成期间的噪声和由于退相干引起的噪声。假设 $w_0$ 和 $\Delta$ 在网络中是统一的，可以将公式(9)中的保真度下界与公式(4)结合起来：
$$\mathcal{F}_{\mathrm{GHZ}} \geq \prod_{e \in R} w_e = \prod_{e \in R} w_0 \Delta^{\tau_e} = w_0^{|R|} \Delta^{\bar{\tau}|R|}$$
这显示了应用于纠缠链路的噪声如何用两个主要组成部分来描述。第一个组成部分描述了在贝尔态生成期间发生的噪声影响，并且取决于路由解决方案的大小 $|R|$。第二个组成部分描述了退相干的影响，它取决于平均年龄 $\bar{\tau}$ 和所需纠缠链路的数量 $|R|$。这里的年龄定义为纠缠链路在用于生成GHZ态时已在量子内存中存储的时隙数。

图7(a)和7(b)显示了与图6相同的模拟场景下，路由解决方案大小和纠缠链路年龄与分发速率的关系。在单路径路由中，路由解决方案是预先计算的，因此对于所有 $Q_c$ 值，R和 $|R|$ 都是固定的。相比之下，结果显示多路径协议选择的路由解决方案大小随着 $Q_c$ 和实现的分发速率的增加而增加。虽然分发速率严格随 $Q_c$ 增加而增加，但路由解决方案大小 $|R|$ 在某个 $Q_c$ 值处达到峰值。多路径协议使用的路由解决方案比星型方法大36%，比树形方法大40%。使用更大的路由解决方案会由于 $w_0^{|R|}$ 项而降低分发态的保真度。图7(b)在y轴上显示了分发速率与纠缠链路的平均年龄 $\bar{\tau}$ 的关系。对于所有协议，增加截止值 $Q_c$ 会增加所用纠缠链路的平均年龄。在图7(b)中，结果显示多路径协议选择的路由解决方案中，纠缠链路的年龄更低，但分发速率高得多。由于多路径路由协议使用的纠缠链路的平均年龄较低，减少了由于退相干引起的噪声影响。此外，对于多路径协议，增加 $Q_c$ 导致的年龄增长比单路径协议小得多。这表明多路径路由可以通过减轻退相干的影响来提高分发态的保真度。

#### **D. 与距离相关的性能**

多路径路由已被证明可以实现与用户之间距离无关的分发速率[23], [24], [30]。然而，这些工作假设了无噪声或纠错后的贝尔态，因此这些结果通常不适用于含噪量子网络。对于使用含噪纠缠链路（$w_e < 1 \forall e \in R$）在量子网络上分发的态，分发态的保真度将严格随 $|R|$ 的增加而降低。我们根据斯坦纳距离 $D_G(S)$ 来定义网络中多个用户之间的距离，即连接S中用户的斯坦纳树的大小。因此，对于含噪贝尔态，无论使用何种路由方法，分发的GHZ态的保真度都将严格随距离的增加而降低。

在第五节-B中，展示了如何调整截止值 $Q_c$ 来优化速率与保真度之间的权衡。使用这种方法，我们评估了协议在不断增加的距离下以高于最小保真度 $\mathcal{F}_{\mathrm{GHZ}} \geq 2/3$ 的速率分发GHZ态的速率。这些协议被模拟用于在 $M \times M$ 网格网络的四个角节点中的用户之间分发一个4量子比特的GHZ态，其中 $p=0.3$。通过增加 $M \times M$ 网格拓扑的大小，用户之间的斯坦纳距离按 $D_G(S) = 3(M-1)$ 增加。对于这些协议，针对每个距离优化了 $Q_c$ 的值，以在保持平均保真度 $\mathcal{F}_{\mathrm{GHZ}} \geq 2/3$ 的同时最大化分发速率。图8显示了所考虑的网络模型中网络大小M与分发速率的关系。误差条显示了使用[63]实现的99.9%置信区间的分发速率的最小似然估计。由于纠缠链路生成是概率性的，当使用单路径路由时，用户之间的距离增加会导致分发速率降低[8]。此外，由于路由解决方案所需大小随距离增加，必须选择较小的 $Q_c$ 值以维持最小GHZ保真度，这进一步降低了分发速率[64]。

对于多路径路由，如果纠缠链路以高于渗透阈值 $p_c$ 的统一概率p生成，则可以实现与距离无关的分发速率。对于在多个时隙上生成（和丢弃）边的图，只要满足以下条件，就可以在链路状态图 $G'_t$ 上实现渗透：
$$P[e \in E'_t] > p_c$$
在时隙t中，纠缠链路存在于 $E'$ 中的概率 $P[e \in E'_t]$ 等于在前k轮内至少有一次成功生成的概率，假设 $k \leq Q_c$：
$$P[e \in E'_t] = 1 - (1-p)^k$$
从公式(13)和(14)中，我们可以找到超过给定拓扑渗透阈值所需的k的最小值：
$$k \geq \frac{\log(1-p_c)}{\log(1-p)}$$
对于 $Q_c$ 的值，使得 $Q_c \geq k$（k来自公式(15)），多路径路由表现出与距离无关的行为。当选择 $Q_c \geq k$ 的截止值时，将实现恒定的分发速率，其中 $\mathbb{E}[T] \approx k$ 且 $\lambda \approx 1/k$。这在 $M=6$ 网格（距离 $D_G(S)=15$）之前的多路径树形协议中被观察到。然而，随着用户之间距离的增加（M增大），需要选择更小的截止值 $Q_c$ 以达到最小保真度要求。随着距离 $D_G(S)$ 的增加，会出现一个点，在该点上，在保持 $Q_c \geq k$ 的同时分发保真度高于最小可接受保真度的GHZ态变得不可行。超过这一点，分发速率随距离的增加呈指数下降。

对于位于角节点的特定用户集，我们看到在 $6\times6$ 网格拓扑中使用多路径路由实现了79倍的分发速率改进。这是单路径路由在网络中的最坏情况分发速率，因此由于多路径路由带来的改进更大。在平均情况下，连接用户所需的路由解决方案更小，因此GHZ态以更高的速率和保真度分发。由于对有效星型路由解决方案的额外要求（例如，所有用户都通过边不相交的路径连接到中心节点），对于所考虑的网络，我们没有看到mp-s协议的与距离无关的行为。对于不太严格的网络条件（例如，更大的 $p, w, \Delta$），可以观察到与距离无关的行为。

### **六、结论和未来工作**

我们提出了使用多路径路由分发多方态的协议，以动态选择路由，利用网络中贝尔态的位置和保真度知识。将此类协议的性能与具有固定路由的单路径方法进行了比较，考虑了分发GHZ态的速率和保真度。结果表明，多路径协议以比单路径路由更高的速率和保真度分发了GHZ态。更高的保真度是由于使用多路径路由时退相干引起的噪声影响减小而实现的。最后，通过选择合适的量子内存截止时间，我们展示了与单路径路由方法相比，分发速率提高了高达8.3倍，保真度提高了高达28%。对于最坏情况的用户集，多路径路由实现的分发速率高达78倍。这些结果表明，多路径路由可用于提高近期量子网络的性能，特别是在量子比特操作含噪的情况下。

未来工作的可能领域包括建模经典延迟的影响和可扩展性。对于多路径路由，观察到的性能改进与由于更高经典延迟引起的退相干增加的影响之间可能存在权衡。另一个未来工作领域是在近期量子网络可能使用的拓扑和需求下评估多路径路由的性能，特别考虑此类方法的可扩展性。另一个未来工作领域可能是将多路径路由与更先进的纠缠分发技术集成，例如“就绪即交换”方法或非统一内存截止[25], [65]。例如，将纠缠提纯与多路径路由集成。多路径路由可用于为纠缠提纯生成多个多方态[36]，或在一条边上持有的多个纠缠链路上执行纠缠提纯。概率性纠缠提纯方案可能对分发速率产生重大影响，但多路径协议对概率性边故障的更高容忍度可能特别有益。

### **参考文献**

## 参考文献

[1] J.I. Cirac, A. K. Ekert, S. F. Huelga, 和 C. Macchiavello，“通过噪声信道的分布式量子计算”，《物理评论A》，第59卷，第4249–4254页，1999年6月。[在线]。可获取：https://link.aps.org/doi/10.1103/PhysRevA.59.4249
[2] S. Wehner, D. Elkouss, 和 R. Hanson，“量子互联网：未来之路的愿景”，《科学》，第362卷，第6412期，p.eaam9288，2018年。
[3] D. Cuomo, M. Caleffi, 和 A. S. Cacciapuoti，“迈向分布式量子计算生态系统”，《IET量子通信》，第1卷，第1期，第3–8页，2020年。
[4] D. Main, P. Drmota, D. Nadlinger, E. Ainley, A. Agrawal, B. Ncho, R. Srinivas, G. Araneda, 和 D. Lucas，“通过光学网络链路的分布式量子计算”，《自然》，第1–6页，2025年。
[5] S. Muralidharan, L. Li, J. Kim, N. Lütkenhaus, 和 L. Jiang，“长距离量子通信的最佳架构”，《科学报告》，第6卷，第1期，第20463页，2016年。
[6] J. Preskill，“NISQ时代的量子计算及以后”，《量子》，第2卷，第79页，2018年。
[7] C. H. Bennett, D. P. DiVincenzo, J. A. Smolin, 和 W. K. Wootters，“混合态纠缠和量子纠错”，《物理评论A》，第54卷，第5期，第3824页，1996年。
[8] K. Azuma, S. Bäuml, T. Coopmans, D. Elkouss, 和 B. Li，“量子网络设计工具”，《AVS量子科学》，第3卷，第1期，2021年，文章编号014101。
[9] H.-J. Briegel, W. Dür, J.I. Cirac, 和 P. Zoller，“量子中继器：不完美局部操作在量子通信中的作用”，《物理评论快报》，第81卷，第5932–5935页，1998年12月。[在线]。可获取：https://link.aps.org/doi/10.1103/PhysRevLett.81.5932
[10] W. J. Munro, K. Azuma, K. Tamaki, 和 K. Nemoto，“深入量子中继器”，《IEEE量子电子学选题期刊》，第21卷，第3期，第78–90页，2015年。
[11] K. Goodenough, D. Elkouss, 和 S. Wehner，“优化量子互联网的中继器方案”，《物理评论A》，第103卷，第3期，第032610页，2021年。
[12] M. Hein, J. Eisert, 和 H. J. Briegel，“图态中的多方纠缠”，《物理评论A》，第69卷，第062311页，2004年6月。[在线]。可获取：https://link.aps.org/doi/10.1103/PhysRevA.69.062311
[13] A. Pirker 和 W. Dür，“一种用于可靠基于纠缠的网络的量子网络堆栈和协议”，《新物理学杂志》，第21卷，第3期，第033003页，2019年。
[14] G.-B. Xu, Q.-Y. Wen, F. Gao, 和 S.-J. Qin，“使用GHZ态的新颖多方量子密钥协商协议”，《量子信息处理》，第13卷，第12期，第2587–2594页，2014年。
[15] S. Oslovich, M. Z. Hossain, T. Thomas, B. Wang, W. O. Krawec, 和 K. Goodenough，“高效量子会议密钥协商在量子网络上的实现”，2025年国际量子通信、网络与计算会议（QCNC），2025年，第315–322页。
[16] Z. Zhang 和 Q. Zhuang，“分布式量子传感”，《量子科学与技术》，第6卷，第4期，2021年，文章编号043001。
[17] S. Singh, F. Gu, S. de Bone, E. Villaseñor, D. Elkouss, 和 J. Borregaard，“用于容错分布式量子计算的模块化架构和纠缠方案”，arXiv预印本arXiv:2408.02837，2024年。
[18] N. H. Nickerson, Y. Li, 和 S. C. Benjamin，“使用非常嘈杂的网络和接近百分之一的局部错误率进行拓扑量子计算”，《自然通讯》，第4卷，第1期，第1756页，2013年。
[19] S. de Bone, P. Möller, C. E. Bradley, T. H. Taminiau, 和 D. Elkouss，“存在存储退相干情况下的分布式表面码阈值”，《AVS量子科学》，第6卷，第3期，2024年。
[20] S. DiAdamo, M. Ghibaudi, 和 J. Cruise，“用于加速VQE的分布式量子计算和网络控制”，《IEEE量子工程汇刊》，第2卷，第1-21页，2021年。[在线]。可获取：http://dx.doi.org/10.1109/TQE.2021.3057908
[21] A. Yimsiriwattana 和 S.J. Lomonaco Jr，“广义GHZ态和分布式量子计算”，arXiv预印本quant-ph/0402148，2004年。
[22] E. D'Hondt 和 P. Panangaden，“W态和GHZ态的计算能力”，arXiv预印本quant-ph/0412177，2004年。
[23] M. Pant, H. Krovi, D. Towsley, L. Tassiulas, L. Jiang, P. Basu, D. Englund, 和 S. Guha，“量子互联网中的纠缠路由”，《npj量子信息》，第5卷，第1期，2019年，文章编号25。
[24] E. Sutcliffe 和 A. Beghelli，“使用多路径路由在量子网络中分发多用户纠缠”，《IEEE量子工程汇刊》，第4卷，第1–15页，2023年。
[25] B. Li, T. Coopmans, 和 D. Elkouss，“量子中继链中截止时间的高效优化”，《IEEE量子工程汇刊》，第2卷，第1–15页，2021年。
[26] G. Iñesta, G. Vardoyan, L. Scavuzzo, 和 S. Wehner，“具有截止时间的均匀中继链中的最优纠缠分发策略”，《npj量子信息》，第9卷，第1期，第46页，2023年。
[27] M. Caleffi，“量子网络的最优路由”，《IEEE Access》，第5卷，第22299–22312页，2017年。
[28] L. Bugalho, B. C. Coutinho, F. A. Monteiro, 和 Y. Omar，“在噪声量子网络中分发多方纠缠”，《量子》，第7卷，第920页，2023年。
[29] E. Sutcliffe, B. Jonnadula, C. L. Gall, A. E. Moylett, 和 C. M. Westoby，“基于双曲Floquet码的分布式量子纠错”，arXiv预印本arXiv:2501.14029，2025年。
[30] A. Patil, M. Pant, D. Englund, D. Towsley, 和 S. Guha，“以距离无关速率在量子网络中生成纠缠”，《npj量子信息》，第8卷，第1期，2022年5月，文章编号51。[在线]。可获取：https://doi.org/10.1038/s41534-022-00536-0
[31] A. Patil, J. I. Jacobson, E. Van Milligen, D. Towsley, 和 S. Guha，“使用时空复用Greenberger–Horne–Zeilinger (GHZ) 测量在量子网络中生成距离无关纠缠”，2021年IEEE国际量子计算与工程会议（QCE）。IEEE，2021年，第334–345页。
[32] Y. Zhao 和 C. Qiao，“用于量子网络吞吐量最大化的冗余纠缠供应和选择”，2021年IEEE INFOCOM - IEEE计算机通信会议。IEEE，2021年，第1–10页。
[33] S. Shi, X. Zhang, 和 C. Qian，“量子网络的并发纠缠路由：模型与设计”，《IEEE/ACM网络汇刊》，第32卷，第3期，第2205–2220页，2024年。
[34] A. Acin, J. I. Cirac, 和 M. Lewenstein，“量子网络中的纠缠渗透”，《自然物理学》，第3卷，第4期，第256–259页，2007年。
[35] E. A. Van Milligen, E. Jacobson, A. Patil, G. Vardoyan, D. Towsley, 和 S. Guha，“使用时间复用中继器的网络纠缠路由”，arXiv预印本arXiv:2308.15028，2023年。
[36] H. Leone, N. R. Miller, D. Singh, N. K. Langford, 和 P. P. Rohde，“QuNet：量子网络中的成本向量分析与多路径纠缠路由”，arXiv预印本arXiv:2105.00418，2021年。
[37] G. Grimmett，《渗透》，数学科学基础丛书。Springer Berlin Heidelberg，1999年。
[38] B. Bollobás，“随机图的演化”，《美国数学会汇刊》，第286卷，第1期，第257–274页，1984年。
[39] D. Deutsch, A. Ekert, R. Jozsa, C. Macchiavello, S. Popescu, 和 A. Sanpera，“量子隐私放大及噪声信道上量子密码学的安全性”，《物理评论快报》，第77卷，第2818–2821页，1996年9月。[在线]。可获取：https://link.aps.org/doi/10.1103/PhysRevLett.77.2818
[40] S. Jansen, K. Goodenough, S. de Bone, D. Gijswijt, 和 D. Elkouss，“通过对称性约简枚举所有双局域Clifford蒸馏协议”，《量子》，第6卷，第715页，2022年5月。[在线]。可获取：https://doi.org/10.22331/q-2022-05-19-715
[41] S. Krastanov, A. S. de la Cerda, 和 P. Narang，“尺寸受限量子设备的异构多方纠缠纯化”，《物理评论研究》，第3卷，第033164页，2021年8月。[在线]。可获取：https://link.aps.org/doi/10.1103/PhysRevResearch.3.033164
[42] S. de Bone, R. Ouyang, K. Goodenough, 和 D. Elkouss，“使用贝尔对创建和蒸馏多方GHZ态的协议”，《IEEE量子工程汇刊》，第1卷，第1–10页，2020年。[在线]。可获取：https://doi.org/10.1109%2Ftqe.2020.3044179
[43] J. Wallnofer, A. Pirker, M. Zwerger, 和 W. Dür，“量子网络中具有最优缩放的多方态生成”，《科学报告》，第9卷，第1期，第314页，2019年。
[44] G. Vardoyan, S. Guha, P. Nain, 和 D. Towsley，“量子纠缠分发交换机的随机分析”，《IEEE量子工程汇刊》，第2卷，第1–16页，2021年。
[45] F. Rozpedek, K. Goodenough, J. Ribeiro, N. Kalb, V. C. Vivoli, A. Reiserer, R. Hanson, S. Wehner, 和 D. Elkouss，“单个顺序量子中继器的参数范围”，《量子科学与技术》，第3卷，第3期，第034002页，2018年4月。[在线]。可获取：http://dx.doi.org/10.1088/2058-9565/aab31b
[46] G. Avis, F. Rozpedek, 和 S. Wehner，“使用中心量子网络节点的多方纠缠分发分析”，《物理评论A》，第107卷，第1期，第01209页，2023年。
[47] A. S. Cacciapuoti, J. Illiano, M. Viscardi, 和 M. Caleffi，“量子互联网中的多方纠缠分发：何时停止！”，《IEEE网络与服务管理汇刊》，第21卷，第6期，第6041–6058页，2024年。
[48] A. Pirker, J. Wallnofer, 和 W. Dür，“量子网络的模块化架构”，《新物理学杂志》，第20卷，第5期，第053054页，2018年。
[49] C. Meignant, D. Markham, 和 F. Grosshans，“在任意量子网络中分发图态”，《物理评论A》，第100卷，第5期，2019年，文章编号052333。
[50] A. Fischer 和 D. Towsley，“在量子网络中分发图态”，2021年IEEE国际量子计算与工程会议（QCE），2021年，第324–333页。
[51] C. Hegde, P. Indyk, 和 L. Schmidt，“奖赏收集斯坦纳树问题的Goemans-Williamson方案的快速自适应变体”，第11届DIMACS实施挑战研讨会，第2卷。第11届DIMACS实施挑战研讨会，2014年。
[52] S. Bäuml, K. Azuma, G. Kato, 和 D. Elkouss，“量子互联网中的纠缠和密钥分发线性规划”，《通讯物理学》，第3卷，第1期，第1–12页，2020年。
[53] V. Kumar, N. K. Chandra, K. P. Seshadreesan, A. Scheller-Wolf, 和 S. Tayur，“量子交换机的最优纠缠蒸馏策略”，2023年IEEE国际量子计算与工程会议（QCE），第01卷，2023年，第1198–1204页。
[54] S. Saha, M. Shalaev, J. O'Reilly, I. Goetting, G. Toh, A. Kalakuntla, Y. Yu, 和 C. Monroe，“通过时间-bin光子介导的囚禁原子高保真远程纠缠”，arXiv预印本arXiv:2406.01761，2024年。
[55] M. A. Nielsen 和 I. L. Chuang，《量子计算与量子信息》。剑桥大学出版社，2010年。
[56] J. Helsen 和 S. Wehner，“量子网络的基准测试程序”，《npj量子信息》，第9卷，第1期，第17页，2023年。
[57] S. S. Chelluri, S. Khatri, 和 P. van Loock，“在贝尔对网络中分发多方纠缠而无需斯坦纳树并减少门成本”，arXiv预印本arXiv:2412.04252，2024年。
[58] E. W. Dijkstra，“关于图论中两个问题的注记”，《数值数学》，第1卷，第1期，第269–271页，1959年。
[59] J. B. Orlin，“最小成本流的多项式时间原始网络单纯形算法”，《数学规划》，第78卷，第109–129页，1997年。
[60] C. Clayton, X. Wu, 和 B. Bhattacharjee，“使用自适应聚类在量子网络上的高效路由”，2024年IEEE第32届国际网络协议会议（ICNP）。IEEE，2024年，第1–12页。
[61] Z. Kiraly 和 P. Kovacs，“最小成本流算法的高效实现”，2012年。[在线]。可获取：https://arxiv.org/abs/1207.6381
[62] T. Coopmans, R. Knegjens, A. Dahlberg, D. Maier, L. Nijsten, J. de Oliveira Filho, M. Papendrecht, J. Rabbie, F. Rozpedek, M. Skrzypczyk, L. Wubben, W. de Jong, D. Podareanu, A. Torres Knoop, D. Elkouss, 和 S. Wehner，“NetSquid：一个用于量子信息的离散事件网络模拟器”，《通讯物理学》，第4卷，第1期，2021年7月，文章编号164。[在线]。可获取：https://doi.org/10.1038/s42005-021-00647-8
[63] C. Gidney，“Stim：一个快速的稳定子电路模拟器”，《量子》，第5卷，第497页，2021年。
[64] L. Praxmeyer，“概率不完美存储器中的重新定位时间”，arXiv预印本arXiv:1309.3407，2013年。
[65] K. Goodenough, T. Coopmans, 和 D. Towsley，“作为中继链中的噪声交换：精确分析、分布和紧密近似”，《量子》，第9卷，第1744页，2025年。
[66] T. Tanizawa, Y. Takeuchi, S. Yamashika, R. Yoshii, 和 S. Tsuchiya，“具有去极化噪声的图态的最简单保真度估计方法”，2023年。[在线]。可获取：https://arxiv.org/abs/2304.10952
[67] S. Broadfoot, U. Dorner, 和 D. Jaksch，“中等规模量子网络中的单态生成”，《物理评论A》，第81卷，第042316页，2010年4月。[在线]。可获取：https://link.aps.org/doi/10.1103/PhysRevA.81.042316
[68] M. Cuquet 和 J. Calsamiglia，“量子复杂网络中的纠缠渗透”，《物理评论快报》，第103卷，第240503页，2009年12月。[在线]。可获取：https://link.aps.org/doi/10.1103/PhysRevLett.103.240503

### **附录A 形式化问题陈述**

所考虑的优化问题包括找到一个路由解决方案R，以最大化GHZ态保真度的方式连接用户S。代替精确保真度，我们最大化保真度下界 $\mathcal{F}_{LB}$，它是边保真度 $\mathcal{F}_e$ 的乘积，其中 $\mathcal{F}_e = (3w_e + 1)/4$。我们专注于路由以最大化保真度，因为多路径协议在固定的链路状态图 $G'$ 上执行路由，因此只需要考虑纠缠链路保真度。对于单路径协议，我们也可以将问题视为仅保真度最大化，因为出于基准测试目的，我们考虑的网络G中边参数 $p, w, Q_c, \Delta$ 是统一的。这确保了在所考虑的网络中，最大化分发保真度的路由解决方案R也将是最大化速率的路由解决方案。

树形方法的路由包括找到跨越 $G'$ 中S的斯坦纳树R以最大化保真度。选择斯坦纳树的问题可以表示为：
$$
\begin{aligned}
\text{minimise} \quad & \sum_{e \in R} c_e \\
\text{subject to} \quad & R \text{ is connected} \\
& S \subseteq R \\
\end{aligned}
$$
通过选择边权重 $c_e = -\log(w_e)$，所选的斯坦纳树将最大化 $\mathcal{F}_{LB}$。对于贝尔态，$\mathcal{F}$ 和w之间的变换是仿射且单调的（$w \in [0,1]$），因此使用 $-\log(\mathcal{F}_e)$ 或 $-\log(w_e)$ 作为所考虑路由算法的边成本将产生相同的最优路由解决方案。

对于基于星型的协议，路由用于选择中心节点 $v_c$ 与每个用户 $s \in S'$ 之间成本最低的一组边不相交路径，其中 $S' = S \setminus \{v_c\}$，考虑了用户也作为中心节点 $v_c$ 运行的情况，因此不需要额外的路径。可以通过将问题转化为最小成本最大流问题[61]来找到最优路由解决方案。我们在单位容量边上定义一个流 $f: E_f \rightarrow \{0,1\}$。

然后，优化问题变为：
$$
\begin{aligned}
\text{minimise} \quad & \sum_{e \in E_f} c_e f_e \\
\text{subject to} \quad & \sum_{(v_c,v) \in E_f} f_{v_c v} - \sum_{(v,v_c) \in E_f} f_{v v_c} = |S'| \\
& \sum_{(u,s) \in E_f} f_{u s} - \sum_{(s,u) \in E_f} f_{s u} = -1, \quad \forall s \in S' \\
& \sum_{(u,v) \in E_f} f_{u v} - \sum_{(v,u) \in E_f} f_{v u} = 0, \\
& \quad \forall v \in V \setminus (S \cup \{v_c\}) \\
& f_e \in \{0,1\}, \quad \forall e \in E_f \\
\end{aligned}
$$
然后可以从 $E_f$ 中 $f_e=1$ 的边构建路由解决方案R。只有当从 $v_c$ 的总流量等于 $|S|$ 并且每个用户都有单位流量时，才接受路由解决方案R。这些条件确保R对应于从 $v_c$ 到每个用户 $s \in S$ 的一组边不相交路径。通过最小化边权重 $c_e = -\log(w_e)$ 的成本，保真度项 $\mathcal{F}_{LB}$ 被最大化。对于mp-s，使用 $G'_t$ 中的边和时隙t中的 $w_e$ 值计算流。对于单路径路由协议，$w_e = w_0$，并考虑G中的所有边进行路由计算。

### **附录B 保真度下界**

保真度下界被用作选择最低成本路由解决方案的计算可行度量。从一组K个含噪贝尔态（保真度为 $\mathcal{F}_i$）融合生成的多方态的保真度可以下界为[43]：
$$\mathcal{F}_{LB} = \prod_{i \in K} \mathcal{F}_i$$
此表达式假设了完美的LOCC操作和去极化噪声。该下界对路由很有用，因为它不依赖于哪些贝尔态被融合在一起的排列。这可以使用维尔纳态的等效（最多重新排列）描述来看出[7]：
$$
\begin{aligned}
\rho_w = \mathcal{F} & |\phi^{+}\rangle\langle\phi^{+}| + \\
& \frac{1-\mathcal{F}}{3} (|\phi^{-}\rangle\langle\phi^{-}| + |\psi^{+}\rangle\langle\psi^{+}| + |\psi^{-}\rangle\langle\psi^{-}|)
\end{aligned}
$$
其中 $\mathcal{F} = (3w+1)/4$，$\{|\phi^{+}\rangle, |\phi^{-}\rangle, |\psi^{+}\rangle, |\psi^{-}\rangle\}$ 是四个贝尔态[7]。在此描述中，保真度 $\mathcal{F}$ 也描述了维尔纳态处于期望的 $|\phi^{+}\rangle$ 态的概率。对于从一组维尔纳态K生成的多方态，下界 $\mathcal{F}_{LB}$ 是所有维尔纳态都处于期望的 $|\phi^{+}\rangle$ 态的概率。从这些维尔纳态生成的多方态的混合态描述可以被描述为对K的子集应用噪声的组合展开[46], [66]。在此描述中，高阶项描述了一个或多个贝尔态处于非期望态对混合态的贡献。这些高阶项对保真度的贡献将严格为正。因此，使用路由解决方案R生成的GHZ态将具有严格高于乘积形式下界 $\mathcal{F}_{LB}$ 的精确保真度。

项 $\mathcal{F}_{LB} = \prod_{e \in R} \mathcal{F}_e$ 用R中纠缠链路的保真度描述了一个保真度下界。然而，如果我们考虑大多数纠缠链路是通过纠缠交换用于生成长程贝尔态的，该下界的准确性可以提高，因为纠缠交换的保真度有简单的解析描述。通过在路由解决方案R的分支B上执行纠缠交换生成的贝尔态的保真度为：
$$\mathcal{F}_B = \frac{3 \prod_{e \in B} w_e + 1}{4}$$
通过使用在R的分支上生成的贝尔态的精确保真度（$B \subseteq R$），可以计算出GHZ态保真度 $\mathcal{F}_{LB'}$ 的更紧下界：
$$\mathcal{F}_{LB'} = \prod_{B \subseteq R} \mathcal{F}_B$$
这种更紧密的近似是一种后处理操作，对路由解决方案的选择没有影响。

图9显示了为图6模拟的 $2.0 \times 10^6$ 个GHZ态的保真度。图9a显示了下界 $\mathcal{F}_{LB}$ 与精确保真度 $\mathcal{F}_{\mathrm{exact}}$ 之间的差异，横跨不同的 $\mathcal{F}_{\mathrm{exact}}$ 值。这里 $\mathcal{F}_{LB}$ 是根据公式(19)计算的，使用纠缠交换后生成的维尔纳态的保真度。$\mathcal{F}_{\mathrm{exact}}$ 的值是使用NetSquid[62]计算的。在y轴上，我们看到对于所有数据点，$\mathcal{F}_{\mathrm{exact}} - \mathcal{F}_{LB}$ 严格为正，进一步证明了 $\mathcal{F}_{LB}$ 是一个下界。请注意，$\mathcal{F}_{LB}$ 仅用于计算路由解决方案，除非另有说明，否则显示的保真度值是精确保真度 $\mathcal{F}_{\mathrm{exact}}$。整个数据集的平均差异为0.0057（1.07%），对于感兴趣的GHZ态（$\mathcal{F} > 1/2$），我们看到 $\mathcal{F}_{\mathrm{exact}} - \mathcal{F}_{LB}$ 的值在 $2 \times 10^{-2} - 10^{-5}$ 范围内。我们发现，当高阶误差项对保真度的贡献较小时，$\mathcal{F}_{LB}$ 是一个很好的近似。我们发现这对于模拟的大多数GHZ态都是如此，特别是对于感兴趣的GHZ态（即 $\mathcal{F} > 1/2$）。

### **附录C 基于融合的多路径路由**

也已经开发了多路径路由协议，其中每个节点通过GHZ基投影测量对其本地持有的所有贝尔态执行融合。此类工作可以在不需要全局链路状态信息的情况下运行，并且已被证明在两个用户之间分发纠缠态时可以实现高分发速率[30], [34], [60], [67], [68]。然而，我们发现，当网络中分发的贝尔态含噪时，此类方法会降低可实现的保真度。在先前关于多路径路由的工作中，贝尔态被假定为理想[24]、纠错[30], [60]，或在特定状态下分发，从而可以使用单态转换在融合前生成理想贝尔态[67], [68]。由于设备能力有限（纠错前）和更一般的（去极化）噪声模型，这些方法在所考虑的网络模型中通常不可行。

我们通过建模两种协议（称为“mp-fuse-global”和“mp-fuse-local”）来检验此类基于融合方法的性能，这两种协议将[30]中提出的基于融合的方法扩展到多用户情况。这些协议的操作如下：
1) 尝试在G的所有边上生成贝尔态。
2) 每个非用户节点对其成功生成的每个贝尔态持有的量子比特执行融合（n量子比特GHZ基测量[30]）。这会测量出每个这些节点上的所有量子比特。
3) 每个用户节点执行纠缠融合（如第三节-C中所述的2量子比特操作），使得一个量子比特保持未测量。
4) 链路状态图 $G'$ 中边度为1的任何非用户节点执行X基测量，以从共享的GHZ态中移除该量子比特。
5) 必须在剩余的量子比特上执行经典通信和局域校正（单量子比特Pauli门），确切的操作取决于测量结果。
6) 在所有这些操作之后，已在用户节点之间成功分发了一个GHZ态。

这两种基于融合的协议在对全局链路状态信息 $G'$ 的要求上有所不同。“mp-fuse-global”协议需要全局链路状态的中央知识，并且仅在中央确认 $G'$ 中所有用户都在同一个连通分量中时才执行融合操作。这是成功分发GHZ态的必要且充分条件。“mp-fuse-local”协议在 $Q_c$ 轮纠缠链路生成后执行融合操作，无需全局链路状态信息 $(G')$ 的集中知识。因此，如果在执行融合时任何用户在 $G'$ 中与其他用户断开连接，则此方法将无法在所有用户之间分发所需的GHZ态，并且必须从步骤1重新开始整个操作。

图10将基于融合方法的分发速率和保真度与其他协议进行了比较，扩展了图6所示的结果。请注意，此处显示的保真度值是公式(8)中描述的保真度下界 $\mathcal{F}_{LB}$。图10显示，mp-t和mp-fuse-global实现了相同的分发速率，但mp-fuse-global的保真度更差。如果贝尔态含噪，则从多个贝尔态（融合或纠缠交换）生成的GHZ态的保真度会随着所需贝尔态数量的增加而降低。对于我们的协议（mp-s或mp-t），保真度与路由解决方案中的边数 $|R|$ 成比例缩放（$O(\mathcal{F}_e^{|R|})$）。对于基于融合的方法，贝尔态的数量与包含用户的整个连通分量 $C$ 中的边数 $|C|$ 成比例缩放（$O(\mathcal{F}_e^{|C|})$）（$G'$ 中包含用户的连通分量）。对于路由成功的 $G'$ 实例，连通分量C的大小可能显著大于路由解决方案R的大小，从而导致保真度显著降低。

基于融合方法的一个关键好处是它们可以仅使用本地链路状态信息运行。然而，我们看到mp-fuse-local协议与mp-fuse-global相比实现了显著更低的分发速率。仅使用本地链路状态知识意味着无论 $G'$ 的状态如何，都会执行融合操作。如果在用户S在 $G'$ 中断开连接时执行融合，则执行融合将无法分发所需的GHZ态。分发的GHZ态将仅在 $G'$ 中处于同一连通分量中的用户之间共享。如果发生故障，协议必须在生成一组新的贝尔态后重新尝试GHZ态分发。此类基于融合的方法（使用本地链路状态知识）在贝尔态经过纠错并且可以以高于渗透阈值的概率生成时表现良好。

### **附录D 对纠缠链路生成概率的敏感性**

在纠缠链路生成概率 $p=0.2, 0.3$ 下模拟了这些协议，其他假设与第五节-B中相同。然而，结果是在60组用户上平均的，而不是100组。纠缠链路生成概率p被调整为图11a中的 $p=0.2$ 和图11b中的 $p=0.3$。在图11a中，结果显示当 $p=0.2$ 时，与第五节-B中看到的结果大体一致。多路径路由协议提供了高达9.5倍的分发速率和30%更高的GHZ态保真度。图11b显示，对于 $p=0.3$，最大速率和保真度改进分别为7.6倍和18%。随着p的增加，多路径路由的好处减少，因为当p更高时，所有协议都实现了更高的分发速率和保真度。在这些协议中，最高的绝对保真度将由 $Q_c=1$ 的sp-t协议实现。这使用了成本最低的路由解决方案，并且所有纠缠链路在每个时隙结束时都被丢弃。任何多路径路由解决方案将至少使用同样多的纠缠链路，因此会降低平均GHZ态保真度。然而，$Q_c=1$ 的截止值在近期量子网络中可能不实用。对于 $Q_c > 1$，多路径协议可以在分发速率和保真度方面实现显著改进。