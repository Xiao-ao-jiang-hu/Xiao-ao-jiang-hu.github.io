---
title: 数值积分的概念
date: 2025-05-27 18:29:23
tags:
    - mathematics
    - numerical-analysis
    - numerical-integration
    - integration-formulas
    - quadrature
    - Gauss-quadrature
    - Newton-Cotes
    - composite-integration
categories:
    - numerical-analysis
excerpt: 本文介绍了数值积分的基本概念，包括数值积分的基本思想、插值型求积公式、复合求积公式以及高斯求积公式。重点讨论了各类求积公式的收敛性、稳定性和代数精度，并提供了具体的例子来说明方法的实现。
---
## 数值积分与相关概念

### 数值积分的基本思想  
数值积分用于解决无法解析求解的积分问题，例如铝制波纹瓦的弧长计算（$\int_{0}^{40} \sqrt{1+\cos^2 x} \, dx$）。其核心思路包括：  
1. Newton-Leibniz公式失效场景：当原函数难以求出（如涉及椭圆积分、$e^{x^2}$等函数）或计算复杂时，需借助数值方法。  
2. 积分定义近似：通过离散化积分区间，计算函数值的加权和（如梯形公式、Monte Carlo方法）。  
3. 机械求积公式：用节点和权重构造近似积分 $I_n(f) = \sum_{k=0}^n A_k f(x_k)$，目标是以较低计算量获得高精度。    
 
### 积分余项与代数精度  
- 积分余项：反映近似误差 $R[f] = I(f) - I_n(f)$，插值型公式的余项与插值误差相关。  
- 代数精度：衡量公式对多项式积分的准确性。  
  - 梯形公式：1次代数精度（对0次、1次多项式精确）。  
  - 中矩形公式：1次代数精度，但对某些二次函数可能更优。  
  - 定理：插值型公式至少具有$n$次代数精度（节点数为$n+1$）。  
 

### 求积公式的收敛性与稳定性  
- 收敛性：当节点数$n \to \infty$且区间分割细化时，积分结果趋近真实值。  
- 稳定性：  
  - 误差控制：若系数$A_k > 0$，则扰动误差满足 $|I_n(f) - I_n(\hat{f})| \leq (b-a)\delta$（理想情况）。  
  - 敏感性：积分问题的绝对条件数为$(b-a)$，通常敏感性较低。  
- 稳定公式：优先选择系数全为正的公式（如梯形公式），避免误差放大。  
 

## 插值型求积公式  
### Newton-Cotes公式

#### 基本思想  
Newton-Cotes公式是一种基于等距节点的插值型求积公式，节点在积分区间 $[a, b]$ 上均匀分布。其形式为：  
$$
I_n(f) = \sum_{k=0}^n A_k f(x_k), \quad A_k = (b-a)C_k^{(n)}
$$  
其中 $C_k^{(n)}$ 为与积分区间无关的Cotes系数，通过拉格朗日插值基函数积分得到。  

#### 常用低阶公式  
- 梯形公式（$n=1$）：
$$
T(f) = \frac{b-a}{2}[f(a) + f(b)]
$$  
- 辛普森公式（$n=2$）：
$$
S(f) = \frac{b-a}{6}\left[f(a) + 4f\left(\frac{a+b}{2}\right) + f(b)\right]
$$  
- Cotes公式（$n=4$）：系数为 $\frac{7}{90}, \frac{32}{90}, \frac{12}{90}, \frac{32}{90}, \frac{7}{90}$  


#### 代数精度与定理  
- 定理7.3：当 $n$ 为偶数时，$n$ 阶Newton-Cotes公式至少有 $n+1$ 次代数精度。  
  - 原因：对称区间上奇函数的积分贡献为零，例如 $n=2$（辛普森公式）可精确积分三次多项式。  
- 示例验证：  
  - 梯形公式（$n=1$）具有1次代数精度，辛普森公式（$n=2$）具有3次代数精度。  


#### 积分余项分析  
- 梯形公式（$n=1$）：  
  $$
  R_T = -\frac{f''(\eta)}{12}(b-a)^3, \quad \eta \in (a, b)
  $$  
- 辛普森公式（$n=2$）：  
  $$
  R_S = -\frac{f^{(4)}(\eta)}{2880}(b-a)^5, \quad \eta \in (a, b)
  $$  
- 中矩形公式（$n=0$）：  
  $$
  R_M = \frac{f''(\eta)}{24}(b-a)^3
  $$  
  余项阶次表明，辛普森公式对光滑函数误差更小，但需更高阶导数存在。  


#### 稳定性与收敛性  
- 稳定性问题：  
  - 当 $n \geq 8$ 时，Cotes系数出现负值，导致公式不稳定（小扰动引发大误差）。  
  - 例：$n=8$ 时系数含负数（如 $-928/28350$）。  
- 收敛性限制：  
  - 高次多项式插值的龙格现象导致高阶公式未必收敛于真实积分值。  
- 实际应用建议：  
  - 优先使用低阶偶数阶公式（如 $n=2, 4$），避免 $n \geq 8$。  

### 复合求积公式

#### 基本思想与动机  
高阶Newton-Cotes公式（如$n \geq 8$）因稳定性差且计算误差可能增大，实际应用中不可靠。复合求积公式通过将积分区间$[a, b]$等分为多个子区间，在每个子区间上应用低阶求积公式（如梯形、Simpson公式），以提高整体精度和稳定性。  
 

#### 复合梯形公式  
- 公式形式：  
  将区间分为$n$等份，每份步长$h = \frac{b-a}{n}$，则复合梯形公式为：  
  
  $$
  T_n = \frac{h}{2} \left[ f(a) + 2\sum_{k=1}^{n-1} f(x_k) + f(b) \right]
  $$  
- 特性：  
  - 稳定性：系数全为正，公式稳定。  
  - 收敛性：当$n \to \infty$，结果收敛于真实积分值（即使被积函数仅可积）。  
  - 误差分析：截断误差为$O(h^2)$，即二阶准确度：  
    
    $$
    I(f) - T_n = -\frac{h^2(b-a)}{12} f''(\eta), \quad \eta \in (a, b)
    $$  
 
#### 复合Simpson公式  
- 公式形式：  
  每子区间$[x_k, x_{k+1}]$取中点$x_{k+1/2}$，公式为：  
  
  $$
  S_n = \frac{h}{6} \left[ f(a) + 4\sum_{k=0}^{n-1} f(x_{k+1/2}) + 2\sum_{k=1}^{n-1} f(x_k) + f(b) \right]
  $$  
- 特性：  
  - 代数精度：三次多项式精确积分（误差阶数更高）。  
  - 误差分析：截断误差为$O(h^4)$，即四阶准确度：  
    
    $$
    I(f) - S_n = -\frac{h^4(b-a)}{2880} f^{(4)}(\eta), \quad \eta \in (a, b)
    $$  
  - 效率：需计算$2n+1$个节点，但精度显著优于复合梯形公式。  
 

#### 步长折半策略  
为动态调整步长$h$以满足精度要求，可通过逐步折半步长并复用已有计算结果：  
- 复合梯形公式递推：  
  步长从$h$折半为$h/2$时，新结果$T_{2n}$可表示为：  
  
  $$
  T_{2n} = \frac{1}{2}T_n + \frac{h}{2} \sum_{k=0}^{n-1} f(x_{k+1/2})
  $$  
  仅需计算新增中点处的函数值，减少重复计算。  
- 复合Simpson公式复用：  
  类似地，步长折半时新增节点与原有节点部分重叠，可高效复用已有数据。  
 

## 高斯求积公式总结

### 基本思想 
高斯求积公式是一种通过优化选择积分节点和权重，实现最高代数精度的数值积分方法。其核心特点包括：  
- 高代数精度：对$n+1$个节点的高斯公式，代数精度可达$2n+1$次（远超等距节点的Newton-Cotes公式）。  
- 非等距节点：节点为特定正交多项式的零点，与权函数正交性紧密相关。  
- 稳定性：所有积分系数均为正数，误差控制能力强。  


### 构造方法  
1. 正交多项式零点作为节点：  
   - 高斯点对应$n+1$次正交多项式的零点（如Legendre、Chebyshev多项式）。  
   - 例如，Legendre多项式对应权函数$\rho(x)=1$，区间为$[-1, 1]$。  
2. 权重计算：  
   - 权重$A_k$通过插值基函数与权函数的积分确定：  
     $$
     A_k = \int_a^b l_k(x) \rho(x) dx
     $$  
   - 权重恒为正，确保公式稳定性。  

### 高斯-勒让德公式

#### 勒让德多项式与高斯点的关系  
高斯-勒让德公式是高斯求积公式在区间 $[-1, 1]$ 上，权函数 $\rho(x) = 1$ 的特例。其积分节点为 勒让德多项式 的零点，权重通过正交性条件确定。

- 勒让德多项式的定义：  
  勒让德多项式 $P_n(x)$ 是满足以下正交条件的多项式：  
  $$
  \int_{-1}^1 P_m(x) P_n(x) \, dx = 0 \quad \text{当} \quad m \neq n
  $$  
  其递推公式为：  
  $$
  P_0(x) = 1, \quad P_1(x) = x, \quad P_{n+1}(x) = \frac{2n+1}{n+1}xP_n(x) - \frac{n}{n+1}P_{n-1}(x)
  $$

- 高斯点的来源：  
  对于 $n+1$ 阶高斯-勒让德公式，节点 $x_0, x_1, \dots, x_n$ 是 $P_{n+1}(x)$ 的零点。这些零点均为单实根，且在区间 $[-1, 1]$ 内对称分布。


#### 低阶公式的推导（以 $n=1$ 为例）  
高斯-勒让德公式的节点和权重可通过求解方程组确定。以 $n=1$（2个节点）为例：  
目标是构造公式：  
$$
G_1(f) = A_0 f(x_0) + A_1 f(x_1)
$$  
使其具有 $2n+1 = 3$ 次代数精度。需满足以下方程：  
$$
\begin{cases}
A_0 + A_1 = \int_{-1}^1 1 \, dx = 2 \quad (\text{积分常数项}) \\
A_0 x_0 + A_1 x_1 = \int_{-1}^1 x \, dx = 0 \quad (\text{积分一次项}) \\
A_0 x_0^2 + A_1 x_1^2 = \int_{-1}^1 x^2 \, dx = \frac{2}{3} \quad (\text{积分二次项}) \\
A_0 x_0^3 + A_1 x_1^3 = \int_{-1}^1 x^3 \, dx = 0 \quad (\text{积分三次项})
\end{cases}
$$

- 对称性简化：  
  由对称性可知 $x_1 = -x_0$，$A_0 = A_1$。代入方程得：  
  $$
  2A_0 = 2 \implies A_0 = 1, \quad A_1 = 1
  $$  
  $$
  2A_0 x_0^2 = \frac{2}{3} \implies x_0^2 = \frac{1}{3} \implies x_0 = \pm \frac{1}{\sqrt{3}} \approx \pm 0.5773503
  $$  
  最终公式为：  
  $$
  G_1(f) = f\left(-\frac{1}{\sqrt{3}}\right) + f\left(\frac{1}{\sqrt{3}}\right)
  $$

#### 高阶节点与权重的计算  
对于更高阶的公式（如 $n=2, 3, 4$），需通过求解更高次的正交多项式零点并计算权重。例如：

- $n=2$（3个节点）：  
  节点为 $P_3(x) = \frac{1}{2}(5x^3 - 3x)$ 的零点：  
  $$
  x_0 = -\sqrt{\frac{3}{5}} \approx -0.7745967, \quad x_1 = 0, \quad x_2 = \sqrt{\frac{3}{5}}
  $$  
  权重通过积分基函数计算：  
  $$
  A_0 = A_2 = \frac{5}{9} \approx 0.5555556, \quad A_1 = \frac{8}{9} \approx 0.8888889
  $$

- 数值表格：  
  以下为部分高斯-勒让德节点与权重表（对称性下仅列非负部分）：  
  | $n$ | 节点 $x_k$         | 权重 $A_k$       |
  |------|---------------------|--------------------|
  | 1    | ±0.5773503          | 1.0                |
  | 2    | 0, ±0.7745967       | 0.8888889, 0.5555556 |
  | 3    | ±0.3399810, ±0.8611363 | 0.6521452, 0.3478548 |
  | 4    | ±0.5384693, ±0.9061798 | 0.4786287, 0.2369269 |


#### 误差余项与收敛性  
- 误差余项（定理7.8）：  
  $$
  R_n[f] = \frac{f^{(2n+2)}(\eta)}{(2n+2)!} \int_{-1}^1 \omega_{n+1}^2(x) \, dx
  $$  
  其中 $\omega_{n+1}(x)$ 是以高斯点为根的多项式。误差随导数阶数指数级下降，适用于高度光滑函数。

- 收敛性（定理7.9）：  
  若 $f(x)$ 在 $[-1, 1]$ 上连续，则当 $n \to \infty$ 时，高斯-勒让德公式结果收敛至真实积分值。


#### 示例  
例7.9：计算 $I = \int_{0}^{1} \frac{\sin x}{x} \, dx$  

1. 变量变换：将区间 $[0, 1]$ 映射到 $[-1, 1]$，令 $x = 0.5 + 0.5t$：  
   $$
   I = \frac{1}{2} \int_{-1}^1 \frac{\sin(0.5 + 0.5t)}{0.5 + 0.5t} \, dt
   $$  

2. 应用高斯-勒让德公式：  
   使用 $n=4$（5个节点）的公式，查表得节点 $x_k$ 和权重 $A_k$，计算：  
   $$
   I \approx \frac{1}{2} \sum_{k=0}^4 A_k \frac{\sin(0.5 + 0.5x_k)}{0.5 + 0.5x_k}
   $$  
   结果为 $I \approx 0.94608312$，精度显著优于复合梯形或Romberg方法。


